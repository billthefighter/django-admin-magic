
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Automatically register and customize Django Admin for your models">
      
      
      
      
        <link rel="prev" href="../mixins/">
      
      
        <link rel="next" href="../utils/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.18">
    
    
      
        <title>registrar - Django Admin Magic</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7e37652d.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#registrar" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Django Admin Magic" class="md-header__button md-logo" aria-label="Django Admin Magic" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Django Admin Magic
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              registrar
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../getting-started/" class="md-tabs__link">
        
  
  
    
  
  Getting Started

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../features/" class="md-tabs__link">
        
  
  
    
  
  Features

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../usage/" class="md-tabs__link">
        
  
  
    
  
  Usage

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../configuration/" class="md-tabs__link">
        
  
  
    
  
  Configuration

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../polymorphic/" class="md-tabs__link">
        
  
  
    
  
  Polymorphic

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../utilities/" class="md-tabs__link">
        
  
  
    
  
  Utilities

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  
  API Reference

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Django Admin Magic" class="md-nav__button md-logo" aria-label="Django Admin Magic" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Django Admin Magic
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../features/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Features
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Usage
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Configuration
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../polymorphic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Polymorphic
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utilities/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Utilities
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" checked>
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mixins/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    mixins
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    registrar
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    registrar
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#django_admin_magic.registrar" class="md-nav__link">
    <span class="md-ellipsis">
      registrar
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#django_admin_magic.registrar.AdminModelRegistrar" class="md-nav__link">
    <span class="md-ellipsis">
      AdminModelRegistrar
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AdminModelRegistrar">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#django_admin_magic.registrar.AdminModelRegistrar--note-this-needs-a-fundamentally-different-approach-the-sync-idea-is-good-because" class="md-nav__link">
    <span class="md-ellipsis">
      NOTE: This needs a fundamentally different approach. The Sync() idea is good, because
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#django_admin_magic.registrar.AdminModelRegistrar--we-need-to-make-sure-the-instances-and-the-adminclasses-actually-have-the-same" class="md-nav__link">
    <span class="md-ellipsis">
      we need to make sure the instances and the adminclasses actually have the same
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#django_admin_magic.registrar.AdminModelRegistrar--attributes-or-you-get-errors-like-this" class="md-nav__link">
    <span class="md-ellipsis">
      attributes or you get errors like this:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#django_admin_magic.registrar.AdminModelRegistrar--admine108-the" class="md-nav__link">
    <span class="md-ellipsis">
      AdminModelRegistrar &para; Class that handles the registration and configuration of Django admin classes for models. This class provides a centralized way to register models with the Django admin site and manage their display properties (list_display, list_filter, etc.). It handles both regular Django models and polymorphic models. General flow: 1. create prototype models (_admin_class_factory) 2. register models (register_models) 2.1. set defaults for fields to show up in admin(init method of listadmin mixin) 3. Modify fields with append methods once admin classes have been registered. NOTE: This needs a fundamentally different approach. The Sync() idea is good, because&para; we need to make sure the instances and the adminclasses actually have the same&para; attributes or you get errors like this:&para; : (admin.E108) The&para; value of 'list_display[5]' refers to 'created_at', which is not a callable, an&para; attribute of 'AdminClass_ProjectAlternateName', or an attribute or method on&para; 'project_tracker.ProjectAlternateName'.&para; As of right now (this commit) all edits using the methods for the registrar are&para; happenin on the widget, not the admin class.&para; They need to be syncd! And the sync code needs to be updated to sync changes from&para; the instance to the admin class prototype.&para; Source code in src/django_admin_magic/registrar.py 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 255 256 257 258 259 260 261 262 263 264 265 266 267 268 269 270 271 272 273 274 275 276 277 278 279 280 281 282 283 284 285 286 287 288 289 290 291 292 293 294 295 296 297 298 299 300 301 302 303 304 305 306 307 308 309 310 311 312 313 314 315 316 317 318 319 320 321 322 323 324 325 326 327 328 329 330 331 332 333 334 335 336 337 338 339 340 341 342 343 344 345 346 347 348 349 350 351 352 353 354 355 356 357 358 359 360 361 362 363 364 365 366 367 368 369 370 371 372 373 374 375 376 377 378 379 380 381 382 383 384 385 386 387 388 389 390 391 392 393 394 395 396 397 398 399 400 401 402 403 404 405 406 407 408 409 410 411 412 413 414 415 416 417 418 419 420 421 422 423 424 425 426 427 428 429 430 431 432 433 434 435 436 437 438 439 440 441 442 443 444 445 446 447 448 449 450 451 452 453 454 455 456 457 458 459 460 461 462 463 464 465 466 467 468 469 470 471 472 473 474 475 476 477 478 479 480 481 482 483 484 485 486 487 488 489 490 491 492 493 494 495 496 497 498 499 500 501 502 503 504 505 506 507 508 509 510 511 512 513 514 515 516 517 518 519 520 521 522 523 524 525 526 527 528 529 530 531 532 533 534 535 536 537 538 539 540 541 542 543 544 545 546 547 548 549 550 551 552 553 554 555 556 557 558 559 560 561 562 563 564 565 566 567 568 569 570 571 572 573 574 575 576 577 578 579 580 581 582 583 584 585 586 587 588 589 590 591 592 593 594 595 596 597 598 599 600 601 602 603 604 605 606 607 608 609 610 611 612 613 614 615 616 617 618 619 620 621 622 623 624 625 626 627 628 629 630 631 632 633 634 635 636 637 638 639 640 641 642 643 644 645 646 647 648 649 650 651 652 653 654 655 656 657 658 659 660 661 662 663 664 665 666 667 668 669 670 671 672 673 674 675 676 677 678 679 680 681 682 683 684 685 686 687 688 689 690 691 692 693 694 695 696 697 698 699 700 701 702 703 704 705 706 707 708 709 710 711 712 713 714 715 716 717 718 719 720 721 722 723 724 725 726 727 728 729 730 731 732 733 734 735 736 737 738 739 740 741 742 743 744 745 746 747 748 749 750 751 752 753 754 755 756 757 758 759 760 761 762 763 764 765 766 767 768 769 770 771 772 773 774 775 776 777 778 779 780 781 782 783 784 785 786 787 788 789 790 791 792 793 794 795 796 797 798 799 800 801 802 803 804 805 806 807 808 809 810 811 812 813 814 815 816 817 818 819 820 821 822 823 824 825 826 827 828 829 830 831 832 833 834 835 836 837 838 839 840 841 842 843 844 845 846 847 848 849 850 851 852 853 854 855 856 857 858 859 860 861 862 863 864 865class AdminModelRegistrar: &quot;&quot;&quot; Class that handles the registration and configuration of Django admin classes for models. This class provides a centralized way to register models with the Django admin site and manage their display properties (list_display, list_filter, etc.). It handles both regular Django models and polymorphic models. General flow: 1. create prototype models (_admin_class_factory) 2. register models (register_models) 2.1. set defaults for fields to show up in admin(__init__ method of listadmin mixin) 3. Modify fields with append methods once admin classes have been registered. #NOTE: This needs a fundamentally different approach. The Sync() idea is good, because # we need to make sure the instances and the adminclasses actually have the same # attributes or you get errors like this: # &lt;class &#39;django.forms.widgets.AdminClass_ProjectAlternateName&#39;&gt;: (admin.E108) The # value of &#39;list_display[5]&#39; refers to &#39;created_at&#39;, which is not a callable, an # attribute of &#39;AdminClass_ProjectAlternateName&#39;, or an attribute or method on # &#39;project_tracker.ProjectAlternateName&#39;. # As of right now (this commit) all edits using the methods for the registrar are # happenin on the widget, not the admin class. # They need to be syncd! And the sync code needs to be updated to sync changes from # the instance to the admin class prototype. &quot;&quot;&quot; def __init__(self, app_label: str | None = None, app_labels: list[str] | None = None, auto_discover: bool = False): &quot;&quot;&quot; Initialize the registrar for specific Django app(s). Args: app_label (str, optional): The label of a single Django app to register models for. app_labels (List[str], optional): List of Django app labels to register models for. auto_discover (bool): Whether to auto-discover and register all installed apps. &quot;&quot;&quot; self.class_dict: dict[str, tuple[InclusiveModelType, AdminClassType]] = {} self.app_labels = self._determine_app_labels(app_label, app_labels, auto_discover) self.do_not_register_filter_string_list = app_settings.DEFAULT_DO_NOT_REGISTER_FILTER_STRING_LIST self.models = [] self._collect_models() self.model_iterator() self.register_models() def _determine_app_labels( self, app_label: str | None, app_labels: list[str] | None, auto_discover: bool ) -&gt; list[str]: &quot;&quot;&quot; Determine which app labels to use based on the provided parameters and settings. Priority order: 1. Explicitly provided app_label or app_labels 2. Settings configuration (APP_LABEL, APP_LABELS, AUTO_DISCOVER_ALL_APPS) 3. Auto-discovery if enabled &quot;&quot;&quot; # If explicit parameters are provided, use them if app_label: return [app_label] if app_labels: return app_labels # Check settings if hasattr(app_settings, &quot;APP_LABEL&quot;) and app_settings.APP_LABEL: if isinstance(app_settings.APP_LABEL, list): return app_settings.APP_LABEL return [app_settings.APP_LABEL] if hasattr(app_settings, &quot;APP_LABELS&quot;) and app_settings.APP_LABELS: return app_settings.APP_LABELS # Auto-discovery if auto_discover or (hasattr(app_settings, &quot;AUTO_DISCOVER_ALL_APPS&quot;) and app_settings.AUTO_DISCOVER_ALL_APPS): return self._discover_app_labels() # Default to empty list if nothing is configured return [] def _discover_app_labels(self) -&gt; list[str]: &quot;&quot;&quot; Discover all Django apps that have models. Returns: List of app labels that have models. &quot;&quot;&quot; discovered_apps = [] for app_config in apps.get_app_configs(): # Skip django_admin_magic itself and other Django system apps if app_config.label in [&quot;django_admin_magic&quot;, &quot;admin&quot;, &quot;auth&quot;, &quot;contenttypes&quot;, &quot;sessions&quot;]: continue # Check if the app has any models models_in_app = list(app_config.get_models()) if len(models_in_app) &gt; 0: discovered_apps.append(app_config.label) logger.info(f&quot;Auto-discovered app: {app_config.label} with {len(models_in_app)} models&quot;) else: # Empty apps during auto-discovery are normal; log at INFO to avoid noisy warnings logger.info(f&quot;Auto-discovery: app &#39;{app_config.label}&#39; has no models; skipping&quot;) return discovered_apps def _collect_models(self): &quot;&quot;&quot;Collect all models from the specified app labels.&quot;&quot;&quot; for app_label in self.app_labels: try: app_config = apps.get_app_config(app_label=app_label) app_models = list(app_config.get_models()) self.models.extend(app_models) if len(app_models) == 0: logger.warning(f&quot;App &#39;{app_label}&#39; has no models; skipping&quot;) else: logger.info(f&quot;Collected {len(app_models)} models from app: {app_label}&quot;) except LookupError: logger.warning(f&quot;App &#39;{app_label}&#39; not found in installed apps&quot;) @classmethod def register_all_discovered_apps(cls) -&gt; &quot;AdminModelRegistrar&quot;: &quot;&quot;&quot; Class method to create a registrar that auto-discovers and registers all apps. This is useful for users who want to register all their models automatically without specifying individual app labels. Returns: AdminModelRegistrar instance configured for auto-discovery &quot;&quot;&quot; return cls(auto_discover=True) @classmethod def register_apps(cls, app_labels: list[str]) -&gt; &quot;AdminModelRegistrar&quot;: &quot;&quot;&quot; Class method to create a registrar for specific app labels. Args: app_labels: List of app labels to register Returns: AdminModelRegistrar instance configured for the specified apps &quot;&quot;&quot; return cls(app_labels=app_labels) @classmethod def register_app(cls, app_label: str) -&gt; &quot;AdminModelRegistrar&quot;: &quot;&quot;&quot; Class method to create a registrar for a single app. Args: app_label: The app label to register Returns: AdminModelRegistrar instance configured for the specified app &quot;&quot;&quot; return cls(app_label=app_label) def model_iterator(self): &quot;&quot;&quot; Iterates through models and creates the associated admin class. Convenience method to create admin classes for models without having to explicitly create them in each app&#39;s admin.py file. &quot;&quot;&quot; for model in self.models: model_name = model.__name__ if isinstance(model, type) else model.__class__.__name__ model_passes_filter = not any(x in model_name for x in self.do_not_register_filter_string_list) if model._meta.abstract is False and model_passes_filter: admin_class = self._admin_class_factory(model, admin.site) self.class_dict[str(model)] = (model, admin_class) def _admin_class_factory(self, model, admin_site): &quot;&quot;&quot;Creates class prototypes for admin_classes depending on the incoming model object.&quot;&quot;&quot; adminclass_name = f&quot;AdminClass_{model.__name__}&quot; common_class_kwargs = {&quot;model&quot;: model, &quot;admin_site&quot;: admin_site} return type( adminclass_name, (ListAdmin,), common_class_kwargs, ) def _tuple_list_handler(self, tuple_or_list: list[Any] | tuple[Any, ...]) -&gt; list[Any]: &quot;&quot;&quot; Convert a tuple or list to a list, preserving order and removing duplicates. This method ensures consistent handling of list-like objects by: 1. Converting tuples to lists 2. Removing duplicate entries while preserving order 3. Handling nested structures recursively Args: tuple_or_list: The input tuple or list to process Returns: A list with duplicates removed while preserving order &quot;&quot;&quot; if isinstance(tuple_or_list, tuple): tuple_or_list = list(tuple_or_list) return list(dict.fromkeys(tuple_or_list)) def _verify_list_display_in_model( self, model: InclusiveModelType, list_display: list[str] | tuple[str], admin_class: admin.ModelAdmin, ): &quot;&quot;&quot; Verify that all fields in list_display exist on the model or the admin class. This method checks both model fields and attributes (including properties) to ensure that all display fields are valid. It handles: 1. Field names that exist on the model 2. Property names that exist on the model 3. Method names that exist on the model 4. Callable objects (like linkify or custom display methods) 5. Single character strings (used for formatting) Args: model: The model to verify fields against list_display: The list of fields to verify admin_class: The admin class associated with the model Raises: FieldDoesNotExist: If a field is not found on the model and doesn&#39;t match any valid pattern &quot;&quot;&quot; # Cast model to appropriate type model_class = cast( &quot;type[models.Model | PolymorphicModel]&quot;, model if isinstance(model, type) else model.__class__, ) model_fields = [field.name for field in model_class._meta.fields] model_attributes = dir(model_class) # Get attributes from the admin class as well admin_class_attributes = dir(admin_class) for field in list_display: # Skip validation for: # 1. Callable objects (custom display methods) # 2. Single character strings (often used for formatting) # 3. Fields that have a short_description (admin display methods) if callable(field) or (isinstance(field, str) and len(field) == 1) or hasattr(field, &quot;short_description&quot;): continue # Check if the field exists on the model OR the admin class if field not in model_fields and field not in model_attributes and field not in admin_class_attributes: if isinstance(field, str): admin_class_name = getattr(admin_class, &quot;__name__&quot;, f&quot;AdminClass_{model_class.__name__}&quot;) msg = ( f&quot;Field {field} not found in model {model_class.__name__} or admin class {admin_class_name}\n&quot; f&quot;Model fields: {model_fields}\n&quot; f&quot;Model attributes: {model_attributes}\n&quot; f&quot;Admin class attributes: {admin_class_attributes}\n&quot; f&quot;List display: {list_display}&quot; ) raise FieldDoesNotExist( msg, ) admin_class_name = getattr(admin_class, &quot;__name__&quot;, f&quot;AdminClass_{model_class.__name__}&quot;) logger.debug( f&quot;Field {field} not found in model {model_class.__name__} or admin class {admin_class_name}&quot;, ) def _sync_admin_instance(self, model: InclusiveModelType) -&gt; None: &quot;&quot;&quot; Sync the admin class with its registered instance. This method ensures that any changes made to the admin class prototype are reflected in the registered instance. This includes: - list_display - list_filter - inlines - actions - methods and their attributes - search fields - custom querysets Args: model: The model whose admin class needs to be synced &quot;&quot;&quot; admin_class = self.return_admin_class_for_model(model) # Get the actual model class if we were passed an instance model_class = cast(&quot;type[models.Model]&quot;, model if isinstance(model, type) else model.__class__) registered_instance = admin.site._registry.get(model_class) if not registered_instance: return # Sync list_display if hasattr(admin_class, &quot;list_display&quot;): # Convert list_display to list and filter out any function objects list_display = [] for item in admin_class.list_display: if callable(item) and not isinstance(item, type): # For callable items (methods), create a wrapper that preserves attributes def create_wrapper(method): def wrapper(*args, **kwargs): return method(*args, **kwargs) # Copy all attributes from the original method for attr in dir(method): if not attr.startswith(&quot;_&quot;): try: setattr(wrapper, attr, getattr(method, attr)) except (AttributeError, TypeError): continue # Copy special attributes if they exist if hasattr(method, &quot;__func__&quot;): wrapper.__func__ = method.__func__ if hasattr(method, &quot;__self__&quot;): wrapper.__self__ = method.__self__ return wrapper list_display.append(create_wrapper(item)) else: list_display.append(item) registered_instance.list_display = list_display # Sync list_filter if hasattr(admin_class, &quot;list_filter&quot;): registered_instance.list_filter = admin_class.list_filter # Sync search_fields if hasattr(admin_class, &quot;search_fields&quot;): registered_instance.search_fields = admin_class.search_fields # Sync readonly_fields if hasattr(admin_class, &quot;readonly_fields&quot;): registered_instance.readonly_fields = admin_class.readonly_fields # Sync list_select_related if hasattr(admin_class, &quot;list_select_related&quot;): registered_instance.list_select_related = admin_class.list_select_related # Sync inlines if hasattr(admin_class, &quot;inlines&quot;): if isinstance(admin_class.inlines, tuple): registered_instance.inlines = list(admin_class.inlines) else: registered_instance.inlines = admin_class.inlines # Sync actions if hasattr(admin_class, &quot;actions&quot;): current_actions = [] if hasattr(registered_instance, &quot;actions&quot;) and registered_instance.actions is not None: # Start with existing actions from the registered instance current_actions = list(registered_instance.actions) admin_actions_to_add = [] if admin_class.actions is not None: # Get actions defined on the admin class prototype admin_actions_to_add = list(admin_class.actions) # Add actions from the admin class prototype if they aren&#39;t already present # in the registered instance&#39;s actions list. We compare by name for callables. for action in admin_actions_to_add: action_name = action if isinstance(action, str) else getattr(action, &quot;__name__&quot;, str(action)) is_present = False for existing_action in current_actions: existing_action_name = ( existing_action if isinstance(existing_action, str) else getattr(existing_action, &quot;__name__&quot;, str(existing_action)) ) if action_name == existing_action_name: is_present = True break if not is_present: # Append the original action (callable or string) current_actions.append(action) # Assign the updated list back to the registered instance registered_instance.actions = current_actions # Sync methods and their attributes for attr_name in dir(admin_class): if not attr_name.startswith(&quot;_&quot;): # Skip private methods try: attr = getattr(admin_class, attr_name) if callable(attr) and not isinstance(attr, type): # Create a wrapper function that will have the attributes def create_wrapper(method): def wrapper(*args, **kwargs): return method(*args, **kwargs) # Copy all attributes from the original method for method_attr in dir(method): if not method_attr.startswith(&quot;_&quot;): try: setattr( wrapper, method_attr, getattr(method, method_attr), ) except (AttributeError, TypeError): continue # Copy special attributes if they exist if hasattr(method, &quot;__func__&quot;): wrapper.__func__ = method.__func__ if hasattr(method, &quot;__self__&quot;): wrapper.__self__ = method.__self__ return wrapper wrapped = create_wrapper(attr) # Set the wrapped method on the instance setattr(registered_instance, attr_name, wrapped) except (AttributeError, TypeError): # Skip any attributes that can&#39;t be accessed or copied continue def update_list_select_related( self, model: InclusiveModelType, list_select_related: list[str] | tuple[str, ...] | bool, ) -&gt; None: &quot;&quot;&quot; Update the list_select_related property for a model&#39;s admin class. This method allows setting the list_select_related property to optimize database queries for the admin changelist view. It can be: - True: Select all foreign key relationships - False: Don&#39;t use any JOINs - List/tuple of field names: Only JOIN the specified relationships Args: model: The model whose admin class should be updated list_select_related: The value to set for list_select_related Example: # To select all foreign keys registrar.update_list_select_related(MyModel, True) # To select specific foreign keys registrar.update_list_select_related(MyModel, [&#39;author&#39;, &#39;category&#39;]) # To disable all automatic JOINs registrar.update_list_select_related(MyModel, False) &quot;&quot;&quot; admin_class = self.return_admin_class_for_model(model) admin_class.list_select_related = list_select_related self._sync_admin_instance(model) def add_admin_method( self, model: InclusiveModelType, method_name: str, method_func: Callable, *, short_description: str | None = None, is_action: bool = False, ) -&gt; None: &quot;&quot;&quot; Add a method to the admin class for a model. This method allows adding custom methods to the admin class, optionally marking them as actions and setting their short descriptions. Args: model: The model to add the method to method_name: The name to give the method method_func: The method to add (should be a function) short_description: Optional description for the method in admin interface is_action: Whether to add this method to the actions list Example: def mark_as_special(modeladmin, request, queryset): queryset.update(is_special=True) registrar.add_admin_method( MyModel, &quot;mark_as_special&quot;, mark_as_special, short_description=&quot;Mark selected items as special&quot;, is_action=True ) &quot;&quot;&quot; # Validate method_name if not method_name or not isinstance(method_name, str): raise ValueError(&quot;method_name must be a non-empty string&quot;) # Validate method_func if method_func is None: raise ValueError(&quot;method_func cannot be None&quot;) # Validate method_name format (should be a valid Python identifier) if not method_name.replace(&quot;_&quot;, &quot;&quot;).isalnum() or method_name[0].isdigit(): raise ValueError(&quot;method_name must be a valid Python identifier&quot;) admin_instance = self.return_admin_class_for_model(model) # This is the actual live instance final_wrapped_method: Callable if is_action: # Wrapper for admin actions # method_func signature: (modeladmin_instance, request, queryset) # Django calls action as: func(modeladmin, request, queryset) # This wrapper ensures the original method_func is called correctly. def action_wrapper(modeladmin_param, request_param, queryset_param): return method_func(modeladmin_param, request_param, queryset_param) final_wrapped_method = action_wrapper else: # Wrapper for display methods (e.g., in list_display) # method_func signature: (modeladmin_instance, model_instance) # Django calls display method as: admin_instance.method_name(model_instance) # &#39;admin_instance&#39; (the live model admin instance) is available from the outer scope. def display_wrapper(obj_param): # obj_param is the model_instance passed by Django # admin_instance is the ModelAdmin instance captured from the outer scope of add_admin_method return method_func(admin_instance, obj_param) final_wrapped_method = display_wrapper # Set the wrapped method directly on the admin instance setattr(admin_instance, method_name, final_wrapped_method) # Set short description if provided (on the final_wrapped_method) if short_description: try: final_wrapped_method.short_description = short_description except AttributeError: logger.warning(f&quot;Could not set short_description on wrapped method {method_name} for model {model}&quot;) # Add to actions if requested if is_action: existing_actions = list(getattr(admin_instance, &quot;actions&quot;, []) or []) action_to_add = final_wrapped_method # Add the callable wrapper already_present = False for existing_action in existing_actions: if existing_action == action_to_add: already_present = True break # Compare by name if functions are different instances but represent the same action if hasattr(existing_action, &quot;__name__&quot;) and existing_action.__name__ == getattr( action_to_add, &quot;__name__&quot;, None, ): already_present = True break if not already_present: existing_actions.append(action_to_add) admin_instance.actions = existing_actions # Sync the changes to the registered instance self._sync_admin_instance(model) def register_models(self): &quot;&quot;&quot; Register models with the Django admin site. This method handles the registration process for all models in the app. It ensures that: 1. Each model gets the correct admin class type (regular or polymorphic) 2. List display and filter properties are properly initialized &quot;&quot;&quot; if not self.class_dict: logger.debug(f&quot;No admin classes to register for app {self.app_labels}&quot;) return # Ensure any explicit app admin.py registrations are loaded first try: from django.contrib.admin import autodiscover as admin_autodiscover admin_autodiscover() except Exception: # Autodiscover may be already executed or unavailable in certain contexts pass for name, model_adminclass_tuple in self.class_dict.items(): logger.debug(f&quot;Registering model {name}&quot;) model, admin_class = model_adminclass_tuple # Skip registration if already registered by third-party/admin.py try: if admin.site.is_registered(model): # type: ignore[attr-defined] logger.info(f&quot;Model {model} already registered; skipping auto-registration&quot;) self._sync_admin_instance(model) continue except Exception: # Fallback to trying and catching AlreadyRegistered pass try: admin.site.register(model, admin_class) # type: ignore self._sync_admin_instance(model) except AlreadyRegistered: # If already registered, sync the instance self._sync_admin_instance(model) def add_search_fields( self, model: InclusiveModelType, search_fields: list[str], ): admin_class = self.return_admin_class_for_model(model) if hasattr(admin_class, &quot;search_fields&quot;): # Pass admin_class to verification self._verify_list_display_in_model(model, search_fields, admin_class) admin_class.search_fields = search_fields # type: ignore self._sync_admin_instance(model) # Sync after modification def append_list_display( self, model: InclusiveModelType, list_display: list[str] | tuple[str], ) -&gt; None: &quot;&quot;&quot; Add fields to the end of the admin display list. This method: 1. Validates that all fields exist on the model 2. Maintains field order while preventing duplicates 3. Updates both the admin class and registered instance Args: model: The model to modify the admin display for list_display: Fields to add to the display list &quot;&quot;&quot; admin_class = self.return_admin_class_for_model(model) if hasattr(admin_class, &quot;list_display&quot;): # Pass admin_class to verification self._verify_list_display_in_model(model, list_display, admin_class) current_list = self._tuple_list_handler(admin_class.list_display) # Add new fields, avoiding duplicates for field in list_display: if field not in current_list: current_list.append(field) admin_class.list_display = current_list self._sync_admin_instance(model) def prepend_list_display( self, model: InclusiveModelType, list_display: str | list[str] | tuple[str], ) -&gt; None: &quot;&quot;&quot; Add fields to the start of the admin display list. This method: 1. Validates that all fields exist on the model 2. Removes any existing instances of the fields 3. Prepends fields to the start of the list 4. Updates both the admin class and registered instance Args: model: The model to modify the admin display for list_display: Field(s) to add to the start of the display list. Can be a single string or list/tuple of strings. &quot;&quot;&quot; admin_class = self.return_admin_class_for_model(model) if hasattr(admin_class, &quot;list_display&quot;): # Convert single string to list fields_to_add = [list_display] if isinstance(list_display, str) else list(list_display) # Pass admin_class to verification self._verify_list_display_in_model(model, fields_to_add, admin_class) current_list = self._tuple_list_handler(admin_class.list_display) # Remove any existing instances of the fields for field in fields_to_add: if field in current_list: current_list.remove(field) # Add new fields at the start for field in reversed(fields_to_add): current_list.insert(0, field) admin_class.list_display = current_list self._sync_admin_instance(model) def remove_list_display( self, model: InclusiveModelType, list_display_to_remove: list[str] | tuple[str], ) -&gt; None: admin_class = self.return_admin_class_for_model(model) admin_class.list_display = [field for field in admin_class.list_display if field not in list_display_to_remove] self._sync_admin_instance(model) def append_filter_display( self, model: type[models.Model] | models.Model | PolymorphicModelBase, list_filter: list[str] | tuple[str], ) -&gt; None: &quot;&quot;&quot; Add filter fields to the admin display. This method adds fields to the list_filter property of the admin class. It follows the same pattern as list_display management: 1. Validates fields exist on the model 2. Maintains field order while preventing duplicates 3. Updates both admin class and registered instance Args: model: The model to add filters to list_filter: List or tuple of field names to add as filters Raises: KeyError: If model not found in registered classes FieldDoesNotExist: If field doesn&#39;t exist on model &quot;&quot;&quot; admin_class = self.return_admin_class_for_model(model) if hasattr(admin_class, &quot;list_filter&quot;): # Pass admin_class to verification (assuming list_filter items should also be valid fields/methods) self._verify_list_display_in_model(model, list_filter, admin_class) admin_class.list_filter = self._tuple_list_handler(admin_class.list_filter) # Ensure no duplicates are added for item in list_filter: if item not in admin_class.list_filter: admin_class.list_filter.append(item) self._sync_admin_instance(model) def return_admin_class_for_model(self, model: InclusiveModelType): &quot;&quot;&quot; Return the admin class for a model. This method retrieves the admin class associated with a model from the class dictionary. It handles both class and instance model references. The returned admin class can be modified to customize various aspects of the admin interface. See Django&#39;s ModelAdmin documentation for all available options. Args: model: The model to get the admin class for Returns: The admin class for the model Raises: KeyError: If the model is not found in the registered classes Example Usage: admin_class = registrar.return_admin_class_for_model(MyModel) admin_class.list_filter += [&quot;is_custom_component&quot;, &quot;category&quot;] admin_class.show_full_result_count = False admin_class.paginator = TimeLimitedPaginator &quot;&quot;&quot; model_class = cast(&quot;type[models.Model]&quot;, model if isinstance(model, type) else model.__class__) registered_instance = admin.site._registry.get(model_class) if registered_instance: return registered_instance msg = f&quot;Model {model_class} not found in registered classes - please register the model first.&quot; raise KeyError(msg) def append_inline( self, model: InclusiveModelType, inline_class: type[admin.TabularInline | admin.StackedInline], ) -&gt; None: &quot;&quot;&quot; Add an inline class to a model&#39;s admin. This method: 1. Gets or creates the inlines list 2. Converts tuple to list if needed 3. Appends the new inline 4. Updates both admin class and registered instance Args: model: The model to add the inline to inline_class: The inline class to add &quot;&quot;&quot; admin_class = self.return_admin_class_for_model(model) # Initialize or convert inlines to list if not hasattr(admin_class, &quot;inlines&quot;): admin_class.inlines = [] elif isinstance(admin_class.inlines, tuple): admin_class.inlines = list(admin_class.inlines) # Add inline if not already present if inline_class not in admin_class.inlines: admin_class.inlines.append(inline_class) self._sync_admin_instance(model) __init__(app_label=None, app_labels=None, auto_discover=False) &para; Initialize the registrar for specific Django app(s). Parameters: Name Type Description Default app_label str The label of a single Django app to register models for. None app_labels List[str] List of Django app labels to register models for. None auto_discover bool Whether to auto-discover and register all installed apps. False Source code in src/django_admin_magic/registrar.py 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121def __init__(self, app_label: str | None = None, app_labels: list[str] | None = None, auto_discover: bool = False): &quot;&quot;&quot; Initialize the registrar for specific Django app(s). Args: app_label (str, optional): The label of a single Django app to register models for. app_labels (List[str], optional): List of Django app labels to register models for. auto_discover (bool): Whether to auto-discover and register all installed apps. &quot;&quot;&quot; self.class_dict: dict[str, tuple[InclusiveModelType, AdminClassType]] = {} self.app_labels = self._determine_app_labels(app_label, app_labels, auto_discover) self.do_not_register_filter_string_list = app_settings.DEFAULT_DO_NOT_REGISTER_FILTER_STRING_LIST self.models = [] self._collect_models() self.model_iterator() self.register_models() add_admin_method(model, method_name, method_func, *, short_description=None, is_action=False) &para; Add a method to the admin class for a model. This method allows adding custom methods to the admin class, optionally marking them as actions and setting their short descriptions. Parameters: Name Type Description Default model InclusiveModelType The model to add the method to required method_name str The name to give the method required method_func Callable The method to add (should be a function) required short_description str | None Optional description for the method in admin interface None is_action bool Whether to add this method to the actions list False Example def mark_as_special(modeladmin, request, queryset): queryset.update(is_special=True) registrar.add_admin_method( MyModel, "mark_as_special", mark_as_special, short_description="Mark selected items as special", is_action=True ) Source code in src/django_admin_magic/registrar.py 525 526 527 528 529 530 531 532 533 534 535 536 537 538 539 540 541 542 543 544 545 546 547 548 549 550 551 552 553 554 555 556 557 558 559 560 561 562 563 564 565 566 567 568 569 570 571 572 573 574 575 576 577 578 579 580 581 582 583 584 585 586 587 588 589 590 591 592 593 594 595 596 597 598 599 600 601 602 603 604 605 606 607 608 609 610 611 612 613 614 615 616 617 618 619 620 621 622 623 624 625 626 627 628 629def add_admin_method( self, model: InclusiveModelType, method_name: str, method_func: Callable, *, short_description: str | None = None, is_action: bool = False, ) -&gt; None: &quot;&quot;&quot; Add a method to the admin class for a model. This method allows adding custom methods to the admin class, optionally marking them as actions and setting their short descriptions. Args: model: The model to add the method to method_name: The name to give the method method_func: The method to add (should be a function) short_description: Optional description for the method in admin interface is_action: Whether to add this method to the actions list Example: def mark_as_special(modeladmin, request, queryset): queryset.update(is_special=True) registrar.add_admin_method( MyModel, &quot;mark_as_special&quot;, mark_as_special, short_description=&quot;Mark selected items as special&quot;, is_action=True ) &quot;&quot;&quot; # Validate method_name if not method_name or not isinstance(method_name, str): raise ValueError(&quot;method_name must be a non-empty string&quot;) # Validate method_func if method_func is None: raise ValueError(&quot;method_func cannot be None&quot;) # Validate method_name format (should be a valid Python identifier) if not method_name.replace(&quot;_&quot;, &quot;&quot;).isalnum() or method_name[0].isdigit(): raise ValueError(&quot;method_name must be a valid Python identifier&quot;) admin_instance = self.return_admin_class_for_model(model) # This is the actual live instance final_wrapped_method: Callable if is_action: # Wrapper for admin actions # method_func signature: (modeladmin_instance, request, queryset) # Django calls action as: func(modeladmin, request, queryset) # This wrapper ensures the original method_func is called correctly. def action_wrapper(modeladmin_param, request_param, queryset_param): return method_func(modeladmin_param, request_param, queryset_param) final_wrapped_method = action_wrapper else: # Wrapper for display methods (e.g., in list_display) # method_func signature: (modeladmin_instance, model_instance) # Django calls display method as: admin_instance.method_name(model_instance) # &#39;admin_instance&#39; (the live model admin instance) is available from the outer scope. def display_wrapper(obj_param): # obj_param is the model_instance passed by Django # admin_instance is the ModelAdmin instance captured from the outer scope of add_admin_method return method_func(admin_instance, obj_param) final_wrapped_method = display_wrapper # Set the wrapped method directly on the admin instance setattr(admin_instance, method_name, final_wrapped_method) # Set short description if provided (on the final_wrapped_method) if short_description: try: final_wrapped_method.short_description = short_description except AttributeError: logger.warning(f&quot;Could not set short_description on wrapped method {method_name} for model {model}&quot;) # Add to actions if requested if is_action: existing_actions = list(getattr(admin_instance, &quot;actions&quot;, []) or []) action_to_add = final_wrapped_method # Add the callable wrapper already_present = False for existing_action in existing_actions: if existing_action == action_to_add: already_present = True break # Compare by name if functions are different instances but represent the same action if hasattr(existing_action, &quot;__name__&quot;) and existing_action.__name__ == getattr( action_to_add, &quot;__name__&quot;, None, ): already_present = True break if not already_present: existing_actions.append(action_to_add) admin_instance.actions = existing_actions # Sync the changes to the registered instance self._sync_admin_instance(model) append_filter_display(model, list_filter) &para; Add filter fields to the admin display. This method adds fields to the list_filter property of the admin class. It follows the same pattern as list_display management: 1. Validates fields exist on the model 2. Maintains field order while preventing duplicates 3. Updates both admin class and registered instance Parameters: Name Type Description Default model type[Model] | Model | PolymorphicModelBase The model to add filters to required list_filter list[str] | tuple[str] List or tuple of field names to add as filters required Raises: Type Description KeyError If model not found in registered classes FieldDoesNotExist If field doesn't exist on model Source code in src/django_admin_magic/registrar.py 765 766 767 768 769 770 771 772 773 774 775 776 777 778 779 780 781 782 783 784 785 786 787 788 789 790 791 792 793 794 795 796 797def append_filter_display( self, model: type[models.Model] | models.Model | PolymorphicModelBase, list_filter: list[str] | tuple[str], ) -&gt; None: &quot;&quot;&quot; Add filter fields to the admin display. This method adds fields to the list_filter property of the admin class. It follows the same pattern as list_display management: 1. Validates fields exist on the model 2. Maintains field order while preventing duplicates 3. Updates both admin class and registered instance Args: model: The model to add filters to list_filter: List or tuple of field names to add as filters Raises: KeyError: If model not found in registered classes FieldDoesNotExist: If field doesn&#39;t exist on model &quot;&quot;&quot; admin_class = self.return_admin_class_for_model(model) if hasattr(admin_class, &quot;list_filter&quot;): # Pass admin_class to verification (assuming list_filter items should also be valid fields/methods) self._verify_list_display_in_model(model, list_filter, admin_class) admin_class.list_filter = self._tuple_list_handler(admin_class.list_filter) # Ensure no duplicates are added for item in list_filter: if item not in admin_class.list_filter: admin_class.list_filter.append(item) self._sync_admin_instance(model) append_inline(model, inline_class) &para; Add an inline class to a model's admin. This method: 1. Gets or creates the inlines list 2. Converts tuple to list if needed 3. Appends the new inline 4. Updates both admin class and registered instance Parameters: Name Type Description Default model InclusiveModelType The model to add the inline to required inline_class type[TabularInline | StackedInline] The inline class to add required Source code in src/django_admin_magic/registrar.py 834 835 836 837 838 839 840 841 842 843 844 845 846 847 848 849 850 851 852 853 854 855 856 857 858 859 860 861 862 863 864 865def append_inline( self, model: InclusiveModelType, inline_class: type[admin.TabularInline | admin.StackedInline], ) -&gt; None: &quot;&quot;&quot; Add an inline class to a model&#39;s admin. This method: 1. Gets or creates the inlines list 2. Converts tuple to list if needed 3. Appends the new inline 4. Updates both admin class and registered instance Args: model: The model to add the inline to inline_class: The inline class to add &quot;&quot;&quot; admin_class = self.return_admin_class_for_model(model) # Initialize or convert inlines to list if not hasattr(admin_class, &quot;inlines&quot;): admin_class.inlines = [] elif isinstance(admin_class.inlines, tuple): admin_class.inlines = list(admin_class.inlines) # Add inline if not already present if inline_class not in admin_class.inlines: admin_class.inlines.append(inline_class) self._sync_admin_instance(model) append_list_display(model, list_display) &para; Add fields to the end of the admin display list. This method: 1. Validates that all fields exist on the model 2. Maintains field order while preventing duplicates 3. Updates both the admin class and registered instance Parameters: Name Type Description Default model InclusiveModelType The model to modify the admin display for required list_display list[str] | tuple[str] Fields to add to the display list required Source code in src/django_admin_magic/registrar.py 685 686 687 688 689 690 691 692 693 694 695 696 697 698 699 700 701 702 703 704 705 706 707 708 709 710 711 712 713def append_list_display( self, model: InclusiveModelType, list_display: list[str] | tuple[str], ) -&gt; None: &quot;&quot;&quot; Add fields to the end of the admin display list. This method: 1. Validates that all fields exist on the model 2. Maintains field order while preventing duplicates 3. Updates both the admin class and registered instance Args: model: The model to modify the admin display for list_display: Fields to add to the display list &quot;&quot;&quot; admin_class = self.return_admin_class_for_model(model) if hasattr(admin_class, &quot;list_display&quot;): # Pass admin_class to verification self._verify_list_display_in_model(model, list_display, admin_class) current_list = self._tuple_list_handler(admin_class.list_display) # Add new fields, avoiding duplicates for field in list_display: if field not in current_list: current_list.append(field) admin_class.list_display = current_list self._sync_admin_instance(model) model_iterator() &para; Iterates through models and creates the associated admin class. Convenience method to create admin classes for models without having to explicitly create them in each app's admin.py file. Source code in src/django_admin_magic/registrar.py 237 238 239 240 241 242 243 244 245 246 247 248def model_iterator(self): &quot;&quot;&quot; Iterates through models and creates the associated admin class. Convenience method to create admin classes for models without having to explicitly create them in each app&#39;s admin.py file. &quot;&quot;&quot; for model in self.models: model_name = model.__name__ if isinstance(model, type) else model.__class__.__name__ model_passes_filter = not any(x in model_name for x in self.do_not_register_filter_string_list) if model._meta.abstract is False and model_passes_filter: admin_class = self._admin_class_factory(model, admin.site) self.class_dict[str(model)] = (model, admin_class) prepend_list_display(model, list_display) &para; Add fields to the start of the admin display list. This method: 1. Validates that all fields exist on the model 2. Removes any existing instances of the fields 3. Prepends fields to the start of the list 4. Updates both the admin class and registered instance Parameters: Name Type Description Default model InclusiveModelType The model to modify the admin display for required list_display str | list[str] | tuple[str] Field(s) to add to the start of the display list. Can be a single string or list/tuple of strings. required Source code in src/django_admin_magic/registrar.py 715 716 717 718 719 720 721 722 723 724 725 726 727 728 729 730 731 732 733 734 735 736 737 738 739 740 741 742 743 744 745 746 747 748 749 750 751 752 753 754def prepend_list_display( self, model: InclusiveModelType, list_display: str | list[str] | tuple[str], ) -&gt; None: &quot;&quot;&quot; Add fields to the start of the admin display list. This method: 1. Validates that all fields exist on the model 2. Removes any existing instances of the fields 3. Prepends fields to the start of the list 4. Updates both the admin class and registered instance Args: model: The model to modify the admin display for list_display: Field(s) to add to the start of the display list. Can be a single string or list/tuple of strings. &quot;&quot;&quot; admin_class = self.return_admin_class_for_model(model) if hasattr(admin_class, &quot;list_display&quot;): # Convert single string to list fields_to_add = [list_display] if isinstance(list_display, str) else list(list_display) # Pass admin_class to verification self._verify_list_display_in_model(model, fields_to_add, admin_class) current_list = self._tuple_list_handler(admin_class.list_display) # Remove any existing instances of the fields for field in fields_to_add: if field in current_list: current_list.remove(field) # Add new fields at the start for field in reversed(fields_to_add): current_list.insert(0, field) admin_class.list_display = current_list self._sync_admin_instance(model) register_all_discovered_apps() classmethod &para; Class method to create a registrar that auto-discovers and registers all apps. This is useful for users who want to register all their models automatically without specifying individual app labels. Returns: Type Description AdminModelRegistrar AdminModelRegistrar instance configured for auto-discovery Source code in src/django_admin_magic/registrar.py 195 196 197 198 199 200 201 202 203 204 205 206 207@classmethod def register_all_discovered_apps(cls) -&gt; &quot;AdminModelRegistrar&quot;: &quot;&quot;&quot; Class method to create a registrar that auto-discovers and registers all apps. This is useful for users who want to register all their models automatically without specifying individual app labels. Returns: AdminModelRegistrar instance configured for auto-discovery &quot;&quot;&quot; return cls(auto_discover=True) register_app(app_label) classmethod &para; Class method to create a registrar for a single app. Parameters: Name Type Description Default app_label str The app label to register required Returns: Type Description AdminModelRegistrar AdminModelRegistrar instance configured for the specified app Source code in src/django_admin_magic/registrar.py 223 224 225 226 227 228 229 230 231 232 233 234 235@classmethod def register_app(cls, app_label: str) -&gt; &quot;AdminModelRegistrar&quot;: &quot;&quot;&quot; Class method to create a registrar for a single app. Args: app_label: The app label to register Returns: AdminModelRegistrar instance configured for the specified app &quot;&quot;&quot; return cls(app_label=app_label) register_apps(app_labels) classmethod &para; Class method to create a registrar for specific app labels. Parameters: Name Type Description Default app_labels list[str] List of app labels to register required Returns: Type Description AdminModelRegistrar AdminModelRegistrar instance configured for the specified apps Source code in src/django_admin_magic/registrar.py 209 210 211 212 213 214 215 216 217 218 219 220 221@classmethod def register_apps(cls, app_labels: list[str]) -&gt; &quot;AdminModelRegistrar&quot;: &quot;&quot;&quot; Class method to create a registrar for specific app labels. Args: app_labels: List of app labels to register Returns: AdminModelRegistrar instance configured for the specified apps &quot;&quot;&quot; return cls(app_labels=app_labels) register_models() &para; Register models with the Django admin site. This method handles the registration process for all models in the app. It ensures that: 1. Each model gets the correct admin class type (regular or polymorphic) 2. List display and filter properties are properly initialized Source code in src/django_admin_magic/registrar.py 631 632 633 634 635 636 637 638 639 640 641 642 643 644 645 646 647 648 649 650 651 652 653 654 655 656 657 658 659 660 661 662 663 664 665 666 667 668 669 670 671def register_models(self): &quot;&quot;&quot; Register models with the Django admin site. This method handles the registration process for all models in the app. It ensures that: 1. Each model gets the correct admin class type (regular or polymorphic) 2. List display and filter properties are properly initialized &quot;&quot;&quot; if not self.class_dict: logger.debug(f&quot;No admin classes to register for app {self.app_labels}&quot;) return # Ensure any explicit app admin.py registrations are loaded first try: from django.contrib.admin import autodiscover as admin_autodiscover admin_autodiscover() except Exception: # Autodiscover may be already executed or unavailable in certain contexts pass for name, model_adminclass_tuple in self.class_dict.items(): logger.debug(f&quot;Registering model {name}&quot;) model, admin_class = model_adminclass_tuple # Skip registration if already registered by third-party/admin.py try: if admin.site.is_registered(model): # type: ignore[attr-defined] logger.info(f&quot;Model {model} already registered; skipping auto-registration&quot;) self._sync_admin_instance(model) continue except Exception: # Fallback to trying and catching AlreadyRegistered pass try: admin.site.register(model, admin_class) # type: ignore self._sync_admin_instance(model) except AlreadyRegistered: # If already registered, sync the instance self._sync_admin_instance(model) return_admin_class_for_model(model) &para; Return the admin class for a model. This method retrieves the admin class associated with a model from the class dictionary. It handles both class and instance model references. The returned admin class can be modified to customize various aspects of the admin interface. See Django's ModelAdmin documentation for all available options. Parameters: Name Type Description Default model InclusiveModelType The model to get the admin class for required Returns: Type Description The admin class for the model Raises: Type Description KeyError If the model is not found in the registered classes Example Usage admin_class = registrar.return_admin_class_for_model(MyModel) admin_class.list_filter += ["is_custom_component", "category"] admin_class.show_full_result_count = False admin_class.paginator = TimeLimitedPaginator Source code in src/django_admin_magic/registrar.py 799 800 801 802 803 804 805 806 807 808 809 810 811 812 813 814 815 816 817 818 819 820 821 822 823 824 825 826 827 828 829 830 831 832def return_admin_class_for_model(self, model: InclusiveModelType): &quot;&quot;&quot; Return the admin class for a model. This method retrieves the admin class associated with a model from the class dictionary. It handles both class and instance model references. The returned admin class can be modified to customize various aspects of the admin interface. See Django&#39;s ModelAdmin documentation for all available options. Args: model: The model to get the admin class for Returns: The admin class for the model Raises: KeyError: If the model is not found in the registered classes Example Usage: admin_class = registrar.return_admin_class_for_model(MyModel) admin_class.list_filter += [&quot;is_custom_component&quot;, &quot;category&quot;] admin_class.show_full_result_count = False admin_class.paginator = TimeLimitedPaginator &quot;&quot;&quot; model_class = cast(&quot;type[models.Model]&quot;, model if isinstance(model, type) else model.__class__) registered_instance = admin.site._registry.get(model_class) if registered_instance: return registered_instance msg = f&quot;Model {model_class} not found in registered classes - please register the model first.&quot; raise KeyError(msg) update_list_select_related(model, list_select_related) &para; Update the list_select_related property for a model's admin class. This method allows setting the list_select_related property to optimize database queries for the admin changelist view. It can be: - True: Select all foreign key relationships - False: Don't use any JOINs - List/tuple of field names: Only JOIN the specified relationships Parameters: Name Type Description Default model InclusiveModelType The model whose admin class should be updated required list_select_related list[str] | tuple[str, ...] | bool The value to set for list_select_related required Example To select all foreign keys&para; registrar.update_list_select_related(MyModel, True) To select specific foreign keys&para; registrar.update_list_select_related(MyModel, ['author', 'category']) To disable all automatic JOINs&para; registrar.update_list_select_related(MyModel, False) Source code in src/django_admin_magic/registrar.py 492 493 494 495 496 497 498 499 500 501 502 503 504 505 506 507 508 509 510 511 512 513 514 515 516 517 518 519 520 521 522 523def update_list_select_related( self, model: InclusiveModelType, list_select_related: list[str] | tuple[str, ...] | bool, ) -&gt; None: &quot;&quot;&quot; Update the list_select_related property for a model&#39;s admin class. This method allows setting the list_select_related property to optimize database queries for the admin changelist view. It can be: - True: Select all foreign key relationships - False: Don&#39;t use any JOINs - List/tuple of field names: Only JOIN the specified relationships Args: model: The model whose admin class should be updated list_select_related: The value to set for list_select_related Example: # To select all foreign keys registrar.update_list_select_related(MyModel, True) # To select specific foreign keys registrar.update_list_select_related(MyModel, [&#39;author&#39;, &#39;category&#39;]) # To disable all automatic JOINs registrar.update_list_select_related(MyModel, False) &quot;&quot;&quot; admin_class = self.return_admin_class_for_model(model) admin_class.list_select_related = list_select_related self._sync_admin_instance(model) NoOpRegistrar &para; Registrar that performs no operations. Used when auto-registration is disabled (e.g., during migrations or when admin is not installed). Provides the same API surface as the real registrar but all methods are safe no-ops to avoid import-time side effects. Source code in src/django_admin_magic/registrar.py 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76class NoOpRegistrar: &quot;&quot;&quot; Registrar that performs no operations. Used when auto-registration is disabled (e.g., during migrations or when admin is not installed). Provides the same API surface as the real registrar but all methods are safe no-ops to avoid import-time side effects. &quot;&quot;&quot; def __init__(self, app_label: str | None = None, app_labels: list[str] | None = None, auto_discover: bool = False): self.app_labels = [] @classmethod def register_all_discovered_apps(cls) -&gt; &quot;NoOpRegistrar&quot;: return cls(auto_discover=True) @classmethod def register_apps(cls, app_labels: list[str]) -&gt; &quot;NoOpRegistrar&quot;: return cls(app_labels=app_labels) @classmethod def register_app(cls, app_label: str) -&gt; &quot;NoOpRegistrar&quot;: return cls(app_label=app_label) # Common mutator methods are implemented as no-ops def register_models(self): return None def return_admin_class_for_model(self, model: InclusiveModelType): raise KeyError(&quot;Auto admin registration is disabled; no admin classes are available.&quot;) def add_search_fields(self, *args, **kwargs): return None def append_list_display(self, *args, **kwargs): return None def prepend_list_display(self, *args, **kwargs): return None def remove_list_display(self, *args, **kwargs): return None def append_filter_display(self, *args, **kwargs): return None def append_inline(self, *args, **kwargs): return None PolymorphicAdminModelRegistrar &para; Bases: AdminModelRegistrar An extension of AdminModelRegistrar that handles polymorphic models. Source code in src/django_admin_magic/registrar.py 868 869 870 871 872 873 874 875 876 877 878 879 880 881 882 883 884 885 886 887 888 889 890class PolymorphicAdminModelRegistrar(AdminModelRegistrar): &quot;&quot;&quot;An extension of AdminModelRegistrar that handles polymorphic models.&quot;&quot;&quot; def _admin_class_factory(self, model, admin_site): &quot;&quot;&quot; Creates class prototypes for admin_classes depending on the incoming model object. This method handles both regular and polymorphic models. &quot;&quot;&quot; adminclass_name = f&quot;AdminClass_{model.__name__}&quot; common_class_kwargs = {&quot;model&quot;: model, &quot;admin_site&quot;: admin_site} if is_polymorphic_model(model): if is_polymorphic_model_parent_model(model): return type( adminclass_name, (PolymorphicParentListAdmin,), common_class_kwargs, ) return type( adminclass_name, (PolymorphicChildListAdmin,), common_class_kwargs, ) return super()._admin_class_factory(model, admin_site) : (admin.E108) The
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#django_admin_magic.registrar.AdminModelRegistrar--value-of-list_display5-refers-to-created_at-which-is-not-a-callable-an" class="md-nav__link">
    <span class="md-ellipsis">
      value of 'list_display[5]' refers to 'created_at', which is not a callable, an
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#django_admin_magic.registrar.AdminModelRegistrar--attribute-of-adminclass_projectalternatename-or-an-attribute-or-method-on" class="md-nav__link">
    <span class="md-ellipsis">
      attribute of 'AdminClass_ProjectAlternateName', or an attribute or method on
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#django_admin_magic.registrar.AdminModelRegistrar--project_trackerprojectalternatename" class="md-nav__link">
    <span class="md-ellipsis">
      'project_tracker.ProjectAlternateName'.
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#django_admin_magic.registrar.AdminModelRegistrar--as-of-right-now-this-commit-all-edits-using-the-methods-for-the-registrar-are" class="md-nav__link">
    <span class="md-ellipsis">
      As of right now (this commit) all edits using the methods for the registrar are
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#django_admin_magic.registrar.AdminModelRegistrar--happenin-on-the-widget-not-the-admin-class" class="md-nav__link">
    <span class="md-ellipsis">
      happenin on the widget, not the admin class.
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#django_admin_magic.registrar.AdminModelRegistrar--they-need-to-be-syncd-and-the-sync-code-needs-to-be-updated-to-sync-changes-from" class="md-nav__link">
    <span class="md-ellipsis">
      They need to be syncd! And the sync code needs to be updated to sync changes from
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#django_admin_magic.registrar.AdminModelRegistrar--the-instance-to-the-admin-class-prototype" class="md-nav__link">
    <span class="md-ellipsis">
      the instance to the admin class prototype.
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#django_admin_magic.registrar.AdminModelRegistrar.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#django_admin_magic.registrar.AdminModelRegistrar.add_admin_method" class="md-nav__link">
    <span class="md-ellipsis">
      add_admin_method
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#django_admin_magic.registrar.AdminModelRegistrar.append_filter_display" class="md-nav__link">
    <span class="md-ellipsis">
      append_filter_display
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#django_admin_magic.registrar.AdminModelRegistrar.append_inline" class="md-nav__link">
    <span class="md-ellipsis">
      append_inline
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#django_admin_magic.registrar.AdminModelRegistrar.append_list_display" class="md-nav__link">
    <span class="md-ellipsis">
      append_list_display
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#django_admin_magic.registrar.AdminModelRegistrar.model_iterator" class="md-nav__link">
    <span class="md-ellipsis">
      model_iterator
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#django_admin_magic.registrar.AdminModelRegistrar.prepend_list_display" class="md-nav__link">
    <span class="md-ellipsis">
      prepend_list_display
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#django_admin_magic.registrar.AdminModelRegistrar.register_all_discovered_apps" class="md-nav__link">
    <span class="md-ellipsis">
      register_all_discovered_apps
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#django_admin_magic.registrar.AdminModelRegistrar.register_app" class="md-nav__link">
    <span class="md-ellipsis">
      register_app
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#django_admin_magic.registrar.AdminModelRegistrar.register_apps" class="md-nav__link">
    <span class="md-ellipsis">
      register_apps
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#django_admin_magic.registrar.AdminModelRegistrar.register_models" class="md-nav__link">
    <span class="md-ellipsis">
      register_models
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#django_admin_magic.registrar.AdminModelRegistrar.return_admin_class_for_model" class="md-nav__link">
    <span class="md-ellipsis">
      return_admin_class_for_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#django_admin_magic.registrar.AdminModelRegistrar.update_list_select_related" class="md-nav__link">
    <span class="md-ellipsis">
      update_list_select_related
    </span>
  </a>
  
    <nav class="md-nav" aria-label="update_list_select_related">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#django_admin_magic.registrar.AdminModelRegistrar.update_list_select_related--to-select-all-foreign-keys" class="md-nav__link">
    <span class="md-ellipsis">
      To select all foreign keys
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#django_admin_magic.registrar.AdminModelRegistrar.update_list_select_related--to-select-specific-foreign-keys" class="md-nav__link">
    <span class="md-ellipsis">
      To select specific foreign keys
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#django_admin_magic.registrar.AdminModelRegistrar.update_list_select_related--to-disable-all-automatic-joins" class="md-nav__link">
    <span class="md-ellipsis">
      To disable all automatic JOINs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#django_admin_magic.registrar.NoOpRegistrar" class="md-nav__link">
    <span class="md-ellipsis">
      NoOpRegistrar
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#django_admin_magic.registrar.PolymorphicAdminModelRegistrar" class="md-nav__link">
    <span class="md-ellipsis">
      PolymorphicAdminModelRegistrar
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    utils
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="registrar">registrar<a class="headerlink" href="#registrar" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-module">



<a id="django_admin_magic.registrar"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="django_admin_magic.registrar.AdminModelRegistrar" class="doc doc-heading">
            <code>AdminModelRegistrar</code>


<a href="#django_admin_magic.registrar.AdminModelRegistrar" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">


        <p>Class that handles the registration and configuration of Django admin classes for models.</p>
<p>This class provides a centralized way to register models with the Django admin site and
manage their display properties (list_display, list_filter, etc.). It handles both regular
Django models and polymorphic models.</p>
<p>General flow:
1. create prototype models (_admin_class_factory)
2. register models (register_models)
    2.1. set defaults for fields to show up in admin(<strong>init</strong> method of listadmin mixin)
3. Modify fields with append methods once admin classes have been registered.</p>
<h3 id="django_admin_magic.registrar.AdminModelRegistrar--note-this-needs-a-fundamentally-different-approach-the-sync-idea-is-good-because">NOTE: This needs a fundamentally different approach. The Sync() idea is good, because<a class="headerlink" href="#django_admin_magic.registrar.AdminModelRegistrar--note-this-needs-a-fundamentally-different-approach-the-sync-idea-is-good-because" title="Permanent link">&para;</a></h3>
<h3 id="django_admin_magic.registrar.AdminModelRegistrar--we-need-to-make-sure-the-instances-and-the-adminclasses-actually-have-the-same">we need to make sure the instances and the adminclasses actually have the same<a class="headerlink" href="#django_admin_magic.registrar.AdminModelRegistrar--we-need-to-make-sure-the-instances-and-the-adminclasses-actually-have-the-same" title="Permanent link">&para;</a></h3>
<h3 id="django_admin_magic.registrar.AdminModelRegistrar--attributes-or-you-get-errors-like-this">attributes or you get errors like this:<a class="headerlink" href="#django_admin_magic.registrar.AdminModelRegistrar--attributes-or-you-get-errors-like-this" title="Permanent link">&para;</a></h3>
<h3 id="django_admin_magic.registrar.AdminModelRegistrar--admine108-the"><class 'django.forms.widgets.AdminClass_ProjectAlternateName'>: (admin.E108) The<a class="headerlink" href="#django_admin_magic.registrar.AdminModelRegistrar--admine108-the" title="Permanent link">&para;</a></h3>
<h3 id="django_admin_magic.registrar.AdminModelRegistrar--value-of-list_display5-refers-to-created_at-which-is-not-a-callable-an">value of 'list_display[5]' refers to 'created_at', which is not a callable, an<a class="headerlink" href="#django_admin_magic.registrar.AdminModelRegistrar--value-of-list_display5-refers-to-created_at-which-is-not-a-callable-an" title="Permanent link">&para;</a></h3>
<h3 id="django_admin_magic.registrar.AdminModelRegistrar--attribute-of-adminclass_projectalternatename-or-an-attribute-or-method-on">attribute of 'AdminClass_ProjectAlternateName', or an attribute or method on<a class="headerlink" href="#django_admin_magic.registrar.AdminModelRegistrar--attribute-of-adminclass_projectalternatename-or-an-attribute-or-method-on" title="Permanent link">&para;</a></h3>
<h3 id="django_admin_magic.registrar.AdminModelRegistrar--project_trackerprojectalternatename">'project_tracker.ProjectAlternateName'.<a class="headerlink" href="#django_admin_magic.registrar.AdminModelRegistrar--project_trackerprojectalternatename" title="Permanent link">&para;</a></h3>
<h3 id="django_admin_magic.registrar.AdminModelRegistrar--as-of-right-now-this-commit-all-edits-using-the-methods-for-the-registrar-are">As of right now (this commit) all edits using the methods for the registrar are<a class="headerlink" href="#django_admin_magic.registrar.AdminModelRegistrar--as-of-right-now-this-commit-all-edits-using-the-methods-for-the-registrar-are" title="Permanent link">&para;</a></h3>
<h3 id="django_admin_magic.registrar.AdminModelRegistrar--happenin-on-the-widget-not-the-admin-class">happenin on the widget, not the admin class.<a class="headerlink" href="#django_admin_magic.registrar.AdminModelRegistrar--happenin-on-the-widget-not-the-admin-class" title="Permanent link">&para;</a></h3>
<h3 id="django_admin_magic.registrar.AdminModelRegistrar--they-need-to-be-syncd-and-the-sync-code-needs-to-be-updated-to-sync-changes-from">They need to be syncd! And the sync code needs to be updated to sync changes from<a class="headerlink" href="#django_admin_magic.registrar.AdminModelRegistrar--they-need-to-be-syncd-and-the-sync-code-needs-to-be-updated-to-sync-changes-from" title="Permanent link">&para;</a></h3>
<h3 id="django_admin_magic.registrar.AdminModelRegistrar--the-instance-to-the-admin-class-prototype">the instance to the admin class prototype.<a class="headerlink" href="#django_admin_magic.registrar.AdminModelRegistrar--the-instance-to-the-admin-class-prototype" title="Permanent link">&para;</a></h3>







              <details class="quote">
                <summary>Source code in <code>src/django_admin_magic/registrar.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">AdminModelRegistrar</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class that handles the registration and configuration of Django admin classes for models.</span>

<span class="sd">    This class provides a centralized way to register models with the Django admin site and</span>
<span class="sd">    manage their display properties (list_display, list_filter, etc.). It handles both regular</span>
<span class="sd">    Django models and polymorphic models.</span>

<span class="sd">    General flow:</span>
<span class="sd">    1. create prototype models (_admin_class_factory)</span>
<span class="sd">    2. register models (register_models)</span>
<span class="sd">        2.1. set defaults for fields to show up in admin(__init__ method of listadmin mixin)</span>
<span class="sd">    3. Modify fields with append methods once admin classes have been registered.</span>
<span class="sd">    #NOTE: This needs a fundamentally different approach. The Sync() idea is good, because</span>
<span class="sd">    # we need to make sure the instances and the adminclasses actually have the same</span>
<span class="sd">    # attributes or you get errors like this:</span>
<span class="sd">    # &lt;class &#39;django.forms.widgets.AdminClass_ProjectAlternateName&#39;&gt;: (admin.E108) The</span>
<span class="sd">    # value of &#39;list_display[5]&#39; refers to &#39;created_at&#39;, which is not a callable, an</span>
<span class="sd">    # attribute of &#39;AdminClass_ProjectAlternateName&#39;, or an attribute or method on</span>
<span class="sd">    # &#39;project_tracker.ProjectAlternateName&#39;.</span>
<span class="sd">    # As of right now (this commit) all edits using the methods for the registrar are</span>
<span class="sd">    # happenin on the widget, not the admin class.</span>
<span class="sd">    # They need to be syncd! And the sync code needs to be updated to sync changes from</span>
<span class="sd">    # the instance to the admin class prototype.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">app_label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">app_labels</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">auto_discover</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the registrar for specific Django app(s).</span>

<span class="sd">        Args:</span>
<span class="sd">            app_label (str, optional): The label of a single Django app to register models for.</span>
<span class="sd">            app_labels (List[str], optional): List of Django app labels to register models for.</span>
<span class="sd">            auto_discover (bool): Whether to auto-discover and register all installed apps.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">class_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">InclusiveModelType</span><span class="p">,</span> <span class="n">AdminClassType</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">app_labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_determine_app_labels</span><span class="p">(</span><span class="n">app_label</span><span class="p">,</span> <span class="n">app_labels</span><span class="p">,</span> <span class="n">auto_discover</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">do_not_register_filter_string_list</span> <span class="o">=</span> <span class="n">app_settings</span><span class="o">.</span><span class="n">DEFAULT_DO_NOT_REGISTER_FILTER_STRING_LIST</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">models</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_collect_models</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model_iterator</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">register_models</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_determine_app_labels</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">app_label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">app_labels</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">auto_discover</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determine which app labels to use based on the provided parameters and settings.</span>

<span class="sd">        Priority order:</span>
<span class="sd">        1. Explicitly provided app_label or app_labels</span>
<span class="sd">        2. Settings configuration (APP_LABEL, APP_LABELS, AUTO_DISCOVER_ALL_APPS)</span>
<span class="sd">        3. Auto-discovery if enabled</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># If explicit parameters are provided, use them</span>
        <span class="k">if</span> <span class="n">app_label</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">app_label</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">app_labels</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">app_labels</span>

        <span class="c1"># Check settings</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">app_settings</span><span class="p">,</span> <span class="s2">&quot;APP_LABEL&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">app_settings</span><span class="o">.</span><span class="n">APP_LABEL</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">app_settings</span><span class="o">.</span><span class="n">APP_LABEL</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">app_settings</span><span class="o">.</span><span class="n">APP_LABEL</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">app_settings</span><span class="o">.</span><span class="n">APP_LABEL</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">app_settings</span><span class="p">,</span> <span class="s2">&quot;APP_LABELS&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">app_settings</span><span class="o">.</span><span class="n">APP_LABELS</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">app_settings</span><span class="o">.</span><span class="n">APP_LABELS</span>

        <span class="c1"># Auto-discovery</span>
        <span class="k">if</span> <span class="n">auto_discover</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="n">app_settings</span><span class="p">,</span> <span class="s2">&quot;AUTO_DISCOVER_ALL_APPS&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">app_settings</span><span class="o">.</span><span class="n">AUTO_DISCOVER_ALL_APPS</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_discover_app_labels</span><span class="p">()</span>

        <span class="c1"># Default to empty list if nothing is configured</span>
        <span class="k">return</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_discover_app_labels</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Discover all Django apps that have models.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of app labels that have models.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">discovered_apps</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">app_config</span> <span class="ow">in</span> <span class="n">apps</span><span class="o">.</span><span class="n">get_app_configs</span><span class="p">():</span>
            <span class="c1"># Skip django_admin_magic itself and other Django system apps</span>
            <span class="k">if</span> <span class="n">app_config</span><span class="o">.</span><span class="n">label</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;django_admin_magic&quot;</span><span class="p">,</span> <span class="s2">&quot;admin&quot;</span><span class="p">,</span> <span class="s2">&quot;auth&quot;</span><span class="p">,</span> <span class="s2">&quot;contenttypes&quot;</span><span class="p">,</span> <span class="s2">&quot;sessions&quot;</span><span class="p">]:</span>
                <span class="k">continue</span>

            <span class="c1"># Check if the app has any models</span>
            <span class="n">models_in_app</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">app_config</span><span class="o">.</span><span class="n">get_models</span><span class="p">())</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">models_in_app</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">discovered_apps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">app_config</span><span class="o">.</span><span class="n">label</span><span class="p">)</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Auto-discovered app: </span><span class="si">{</span><span class="n">app_config</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2"> with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">models_in_app</span><span class="p">)</span><span class="si">}</span><span class="s2"> models&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Empty apps during auto-discovery are normal; log at INFO to avoid noisy warnings</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Auto-discovery: app &#39;</span><span class="si">{</span><span class="n">app_config</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2">&#39; has no models; skipping&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">discovered_apps</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_collect_models</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Collect all models from the specified app labels.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">app_label</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">app_labels</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">app_config</span> <span class="o">=</span> <span class="n">apps</span><span class="o">.</span><span class="n">get_app_config</span><span class="p">(</span><span class="n">app_label</span><span class="o">=</span><span class="n">app_label</span><span class="p">)</span>
                <span class="n">app_models</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">app_config</span><span class="o">.</span><span class="n">get_models</span><span class="p">())</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">app_models</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">app_models</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;App &#39;</span><span class="si">{</span><span class="n">app_label</span><span class="si">}</span><span class="s2">&#39; has no models; skipping&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Collected </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">app_models</span><span class="p">)</span><span class="si">}</span><span class="s2"> models from app: </span><span class="si">{</span><span class="n">app_label</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">LookupError</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;App &#39;</span><span class="si">{</span><span class="n">app_label</span><span class="si">}</span><span class="s2">&#39; not found in installed apps&quot;</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">register_all_discovered_apps</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;AdminModelRegistrar&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Class method to create a registrar that auto-discovers and registers all apps.</span>

<span class="sd">        This is useful for users who want to register all their models automatically</span>
<span class="sd">        without specifying individual app labels.</span>

<span class="sd">        Returns:</span>
<span class="sd">            AdminModelRegistrar instance configured for auto-discovery</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">auto_discover</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">register_apps</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">app_labels</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s2">&quot;AdminModelRegistrar&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Class method to create a registrar for specific app labels.</span>

<span class="sd">        Args:</span>
<span class="sd">            app_labels: List of app labels to register</span>

<span class="sd">        Returns:</span>
<span class="sd">            AdminModelRegistrar instance configured for the specified apps</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">app_labels</span><span class="o">=</span><span class="n">app_labels</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">register_app</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">app_label</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;AdminModelRegistrar&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Class method to create a registrar for a single app.</span>

<span class="sd">        Args:</span>
<span class="sd">            app_label: The app label to register</span>

<span class="sd">        Returns:</span>
<span class="sd">            AdminModelRegistrar instance configured for the specified app</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">app_label</span><span class="o">=</span><span class="n">app_label</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">model_iterator</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Iterates through models and creates the associated admin class.</span>
<span class="sd">        Convenience method to create admin classes for models without</span>
<span class="sd">        having to explicitly create them in each app&#39;s admin.py file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">:</span>
            <span class="n">model_name</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="vm">__name__</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="nb">type</span><span class="p">)</span> <span class="k">else</span> <span class="n">model</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
            <span class="n">model_passes_filter</span> <span class="o">=</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">x</span> <span class="ow">in</span> <span class="n">model_name</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_not_register_filter_string_list</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">abstract</span> <span class="ow">is</span> <span class="kc">False</span> <span class="ow">and</span> <span class="n">model_passes_filter</span><span class="p">:</span>
                <span class="n">admin_class</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_admin_class_factory</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">class_dict</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">model</span><span class="p">)]</span> <span class="o">=</span> <span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">admin_class</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_admin_class_factory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">admin_site</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Creates class prototypes for admin_classes depending on the incoming model object.&quot;&quot;&quot;</span>
        <span class="n">adminclass_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;AdminClass_</span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">common_class_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;model&quot;</span><span class="p">:</span> <span class="n">model</span><span class="p">,</span> <span class="s2">&quot;admin_site&quot;</span><span class="p">:</span> <span class="n">admin_site</span><span class="p">}</span>
        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span>
            <span class="n">adminclass_name</span><span class="p">,</span>
            <span class="p">(</span><span class="n">ListAdmin</span><span class="p">,),</span>
            <span class="n">common_class_kwargs</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_tuple_list_handler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tuple_or_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="o">...</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert a tuple or list to a list, preserving order and removing duplicates.</span>

<span class="sd">        This method ensures consistent handling of list-like objects by:</span>
<span class="sd">        1. Converting tuples to lists</span>
<span class="sd">        2. Removing duplicate entries while preserving order</span>
<span class="sd">        3. Handling nested structures recursively</span>

<span class="sd">        Args:</span>
<span class="sd">            tuple_or_list: The input tuple or list to process</span>

<span class="sd">        Returns:</span>
<span class="sd">            A list with duplicates removed while preserving order</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tuple_or_list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">tuple_or_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">tuple_or_list</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">dict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="n">tuple_or_list</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_verify_list_display_in_model</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">model</span><span class="p">:</span> <span class="n">InclusiveModelType</span><span class="p">,</span>
        <span class="n">list_display</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">admin_class</span><span class="p">:</span> <span class="n">admin</span><span class="o">.</span><span class="n">ModelAdmin</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Verify that all fields in list_display exist on the model or the admin class.</span>

<span class="sd">        This method checks both model fields and attributes (including properties)</span>
<span class="sd">        to ensure that all display fields are valid. It handles:</span>
<span class="sd">        1. Field names that exist on the model</span>
<span class="sd">        2. Property names that exist on the model</span>
<span class="sd">        3. Method names that exist on the model</span>
<span class="sd">        4. Callable objects (like linkify or custom display methods)</span>
<span class="sd">        5. Single character strings (used for formatting)</span>

<span class="sd">        Args:</span>
<span class="sd">            model: The model to verify fields against</span>
<span class="sd">            list_display: The list of fields to verify</span>
<span class="sd">            admin_class: The admin class associated with the model</span>

<span class="sd">        Raises:</span>
<span class="sd">            FieldDoesNotExist: If a field is not found on the model and doesn&#39;t match any valid pattern</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Cast model to appropriate type</span>
        <span class="n">model_class</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span>
            <span class="s2">&quot;type[models.Model | PolymorphicModel]&quot;</span><span class="p">,</span>
            <span class="n">model</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="nb">type</span><span class="p">)</span> <span class="k">else</span> <span class="n">model</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">model_fields</span> <span class="o">=</span> <span class="p">[</span><span class="n">field</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">model_class</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">fields</span><span class="p">]</span>
        <span class="n">model_attributes</span> <span class="o">=</span> <span class="nb">dir</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span>
        <span class="c1"># Get attributes from the admin class as well</span>
        <span class="n">admin_class_attributes</span> <span class="o">=</span> <span class="nb">dir</span><span class="p">(</span><span class="n">admin_class</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">list_display</span><span class="p">:</span>
            <span class="c1"># Skip validation for:</span>
            <span class="c1"># 1. Callable objects (custom display methods)</span>
            <span class="c1"># 2. Single character strings (often used for formatting)</span>
            <span class="c1"># 3. Fields that have a short_description (admin display methods)</span>
            <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">field</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">field</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="s2">&quot;short_description&quot;</span><span class="p">):</span>
                <span class="k">continue</span>

            <span class="c1"># Check if the field exists on the model OR the admin class</span>
            <span class="k">if</span> <span class="n">field</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">model_fields</span> <span class="ow">and</span> <span class="n">field</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">model_attributes</span> <span class="ow">and</span> <span class="n">field</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">admin_class_attributes</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="n">admin_class_name</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">admin_class</span><span class="p">,</span> <span class="s2">&quot;__name__&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;AdminClass_</span><span class="si">{</span><span class="n">model_class</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Field </span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2"> not found in model </span><span class="si">{</span><span class="n">model_class</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> or admin class </span><span class="si">{</span><span class="n">admin_class_name</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;Model fields: </span><span class="si">{</span><span class="n">model_fields</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;Model attributes: </span><span class="si">{</span><span class="n">model_attributes</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;Admin class attributes: </span><span class="si">{</span><span class="n">admin_class_attributes</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;List display: </span><span class="si">{</span><span class="n">list_display</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="p">)</span>
                    <span class="k">raise</span> <span class="n">FieldDoesNotExist</span><span class="p">(</span>
                        <span class="n">msg</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="n">admin_class_name</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">admin_class</span><span class="p">,</span> <span class="s2">&quot;__name__&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;AdminClass_</span><span class="si">{</span><span class="n">model_class</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Field </span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2"> not found in model </span><span class="si">{</span><span class="n">model_class</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> or admin class </span><span class="si">{</span><span class="n">admin_class_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_sync_admin_instance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="n">InclusiveModelType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sync the admin class with its registered instance.</span>

<span class="sd">        This method ensures that any changes made to the admin class prototype</span>
<span class="sd">        are reflected in the registered instance. This includes:</span>
<span class="sd">        - list_display</span>
<span class="sd">        - list_filter</span>
<span class="sd">        - inlines</span>
<span class="sd">        - actions</span>
<span class="sd">        - methods and their attributes</span>
<span class="sd">        - search fields</span>
<span class="sd">        - custom querysets</span>


<span class="sd">        Args:</span>
<span class="sd">            model: The model whose admin class needs to be synced</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">admin_class</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_admin_class_for_model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="c1"># Get the actual model class if we were passed an instance</span>
        <span class="n">model_class</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="s2">&quot;type[models.Model]&quot;</span><span class="p">,</span> <span class="n">model</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="nb">type</span><span class="p">)</span> <span class="k">else</span> <span class="n">model</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span>
        <span class="n">registered_instance</span> <span class="o">=</span> <span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">_registry</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">registered_instance</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="c1"># Sync list_display</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">admin_class</span><span class="p">,</span> <span class="s2">&quot;list_display&quot;</span><span class="p">):</span>
            <span class="c1"># Convert list_display to list and filter out any function objects</span>
            <span class="n">list_display</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">admin_class</span><span class="o">.</span><span class="n">list_display</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">type</span><span class="p">):</span>
                    <span class="c1"># For callable items (methods), create a wrapper that preserves attributes</span>
                    <span class="k">def</span><span class="w"> </span><span class="nf">create_wrapper</span><span class="p">(</span><span class="n">method</span><span class="p">):</span>
                        <span class="k">def</span><span class="w"> </span><span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
                            <span class="k">return</span> <span class="n">method</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

                        <span class="c1"># Copy all attributes from the original method</span>
                        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">method</span><span class="p">):</span>
                            <span class="k">if</span> <span class="ow">not</span> <span class="n">attr</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">):</span>
                                <span class="k">try</span><span class="p">:</span>
                                    <span class="nb">setattr</span><span class="p">(</span><span class="n">wrapper</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">attr</span><span class="p">))</span>
                                <span class="k">except</span> <span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
                                    <span class="k">continue</span>
                        <span class="c1"># Copy special attributes if they exist</span>
                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="s2">&quot;__func__&quot;</span><span class="p">):</span>
                            <span class="n">wrapper</span><span class="o">.</span><span class="vm">__func__</span> <span class="o">=</span> <span class="n">method</span><span class="o">.</span><span class="vm">__func__</span>
                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="s2">&quot;__self__&quot;</span><span class="p">):</span>
                            <span class="n">wrapper</span><span class="o">.</span><span class="vm">__self__</span> <span class="o">=</span> <span class="n">method</span><span class="o">.</span><span class="vm">__self__</span>
                        <span class="k">return</span> <span class="n">wrapper</span>

                    <span class="n">list_display</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">create_wrapper</span><span class="p">(</span><span class="n">item</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">list_display</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
            <span class="n">registered_instance</span><span class="o">.</span><span class="n">list_display</span> <span class="o">=</span> <span class="n">list_display</span>

        <span class="c1"># Sync list_filter</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">admin_class</span><span class="p">,</span> <span class="s2">&quot;list_filter&quot;</span><span class="p">):</span>
            <span class="n">registered_instance</span><span class="o">.</span><span class="n">list_filter</span> <span class="o">=</span> <span class="n">admin_class</span><span class="o">.</span><span class="n">list_filter</span>

        <span class="c1"># Sync search_fields</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">admin_class</span><span class="p">,</span> <span class="s2">&quot;search_fields&quot;</span><span class="p">):</span>
            <span class="n">registered_instance</span><span class="o">.</span><span class="n">search_fields</span> <span class="o">=</span> <span class="n">admin_class</span><span class="o">.</span><span class="n">search_fields</span>

        <span class="c1"># Sync readonly_fields</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">admin_class</span><span class="p">,</span> <span class="s2">&quot;readonly_fields&quot;</span><span class="p">):</span>
            <span class="n">registered_instance</span><span class="o">.</span><span class="n">readonly_fields</span> <span class="o">=</span> <span class="n">admin_class</span><span class="o">.</span><span class="n">readonly_fields</span>

        <span class="c1"># Sync list_select_related</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">admin_class</span><span class="p">,</span> <span class="s2">&quot;list_select_related&quot;</span><span class="p">):</span>
            <span class="n">registered_instance</span><span class="o">.</span><span class="n">list_select_related</span> <span class="o">=</span> <span class="n">admin_class</span><span class="o">.</span><span class="n">list_select_related</span>

        <span class="c1"># Sync inlines</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">admin_class</span><span class="p">,</span> <span class="s2">&quot;inlines&quot;</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">admin_class</span><span class="o">.</span><span class="n">inlines</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="n">registered_instance</span><span class="o">.</span><span class="n">inlines</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">admin_class</span><span class="o">.</span><span class="n">inlines</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">registered_instance</span><span class="o">.</span><span class="n">inlines</span> <span class="o">=</span> <span class="n">admin_class</span><span class="o">.</span><span class="n">inlines</span>

        <span class="c1"># Sync actions</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">admin_class</span><span class="p">,</span> <span class="s2">&quot;actions&quot;</span><span class="p">):</span>
            <span class="n">current_actions</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">registered_instance</span><span class="p">,</span> <span class="s2">&quot;actions&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">registered_instance</span><span class="o">.</span><span class="n">actions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># Start with existing actions from the registered instance</span>
                <span class="n">current_actions</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">registered_instance</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>

            <span class="n">admin_actions_to_add</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="n">admin_class</span><span class="o">.</span><span class="n">actions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># Get actions defined on the admin class prototype</span>
                <span class="n">admin_actions_to_add</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">admin_class</span><span class="o">.</span><span class="n">actions</span><span class="p">)</span>

            <span class="c1"># Add actions from the admin class prototype if they aren&#39;t already present</span>
            <span class="c1"># in the registered instance&#39;s actions list. We compare by name for callables.</span>
            <span class="k">for</span> <span class="n">action</span> <span class="ow">in</span> <span class="n">admin_actions_to_add</span><span class="p">:</span>
                <span class="n">action_name</span> <span class="o">=</span> <span class="n">action</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="s2">&quot;__name__&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">action</span><span class="p">))</span>
                <span class="n">is_present</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">for</span> <span class="n">existing_action</span> <span class="ow">in</span> <span class="n">current_actions</span><span class="p">:</span>
                    <span class="n">existing_action_name</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="n">existing_action</span>
                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">existing_action</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
                        <span class="k">else</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">existing_action</span><span class="p">,</span> <span class="s2">&quot;__name__&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">existing_action</span><span class="p">))</span>
                    <span class="p">)</span>
                    <span class="k">if</span> <span class="n">action_name</span> <span class="o">==</span> <span class="n">existing_action_name</span><span class="p">:</span>
                        <span class="n">is_present</span> <span class="o">=</span> <span class="kc">True</span>
                        <span class="k">break</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">is_present</span><span class="p">:</span>
                    <span class="c1"># Append the original action (callable or string)</span>
                    <span class="n">current_actions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>

            <span class="c1"># Assign the updated list back to the registered instance</span>
            <span class="n">registered_instance</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="n">current_actions</span>

        <span class="c1"># Sync methods and their attributes</span>
        <span class="k">for</span> <span class="n">attr_name</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">admin_class</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">attr_name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">):</span>  <span class="c1"># Skip private methods</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">attr</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">admin_class</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">)</span>
                    <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">attr</span><span class="p">,</span> <span class="nb">type</span><span class="p">):</span>
                        <span class="c1"># Create a wrapper function that will have the attributes</span>
                        <span class="k">def</span><span class="w"> </span><span class="nf">create_wrapper</span><span class="p">(</span><span class="n">method</span><span class="p">):</span>
                            <span class="k">def</span><span class="w"> </span><span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
                                <span class="k">return</span> <span class="n">method</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

                            <span class="c1"># Copy all attributes from the original method</span>
                            <span class="k">for</span> <span class="n">method_attr</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">method</span><span class="p">):</span>
                                <span class="k">if</span> <span class="ow">not</span> <span class="n">method_attr</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">):</span>
                                    <span class="k">try</span><span class="p">:</span>
                                        <span class="nb">setattr</span><span class="p">(</span>
                                            <span class="n">wrapper</span><span class="p">,</span>
                                            <span class="n">method_attr</span><span class="p">,</span>
                                            <span class="nb">getattr</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">method_attr</span><span class="p">),</span>
                                        <span class="p">)</span>
                                    <span class="k">except</span> <span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
                                        <span class="k">continue</span>
                            <span class="c1"># Copy special attributes if they exist</span>
                            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="s2">&quot;__func__&quot;</span><span class="p">):</span>
                                <span class="n">wrapper</span><span class="o">.</span><span class="vm">__func__</span> <span class="o">=</span> <span class="n">method</span><span class="o">.</span><span class="vm">__func__</span>
                            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="s2">&quot;__self__&quot;</span><span class="p">):</span>
                                <span class="n">wrapper</span><span class="o">.</span><span class="vm">__self__</span> <span class="o">=</span> <span class="n">method</span><span class="o">.</span><span class="vm">__self__</span>
                            <span class="k">return</span> <span class="n">wrapper</span>

                        <span class="n">wrapped</span> <span class="o">=</span> <span class="n">create_wrapper</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span>
                        <span class="c1"># Set the wrapped method on the instance</span>
                        <span class="nb">setattr</span><span class="p">(</span><span class="n">registered_instance</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">,</span> <span class="n">wrapped</span><span class="p">)</span>
                <span class="k">except</span> <span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
                    <span class="c1"># Skip any attributes that can&#39;t be accessed or copied</span>
                    <span class="k">continue</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">update_list_select_related</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">model</span><span class="p">:</span> <span class="n">InclusiveModelType</span><span class="p">,</span>
        <span class="n">list_select_related</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update the list_select_related property for a model&#39;s admin class.</span>

<span class="sd">        This method allows setting the list_select_related property to optimize</span>
<span class="sd">        database queries for the admin changelist view. It can be:</span>
<span class="sd">        - True: Select all foreign key relationships</span>
<span class="sd">        - False: Don&#39;t use any JOINs</span>
<span class="sd">        - List/tuple of field names: Only JOIN the specified relationships</span>

<span class="sd">        Args:</span>
<span class="sd">            model: The model whose admin class should be updated</span>
<span class="sd">            list_select_related: The value to set for list_select_related</span>

<span class="sd">        Example:</span>
<span class="sd">            # To select all foreign keys</span>
<span class="sd">            registrar.update_list_select_related(MyModel, True)</span>

<span class="sd">            # To select specific foreign keys</span>
<span class="sd">            registrar.update_list_select_related(MyModel, [&#39;author&#39;, &#39;category&#39;])</span>

<span class="sd">            # To disable all automatic JOINs</span>
<span class="sd">            registrar.update_list_select_related(MyModel, False)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">admin_class</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_admin_class_for_model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="n">admin_class</span><span class="o">.</span><span class="n">list_select_related</span> <span class="o">=</span> <span class="n">list_select_related</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sync_admin_instance</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_admin_method</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">model</span><span class="p">:</span> <span class="n">InclusiveModelType</span><span class="p">,</span>
        <span class="n">method_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">method_func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">short_description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">is_action</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add a method to the admin class for a model.</span>

<span class="sd">        This method allows adding custom methods to the admin class, optionally</span>
<span class="sd">        marking them as actions and setting their short descriptions.</span>

<span class="sd">        Args:</span>
<span class="sd">            model: The model to add the method to</span>
<span class="sd">            method_name: The name to give the method</span>
<span class="sd">            method_func: The method to add (should be a function)</span>
<span class="sd">            short_description: Optional description for the method in admin interface</span>
<span class="sd">            is_action: Whether to add this method to the actions list</span>

<span class="sd">        Example:</span>
<span class="sd">            def mark_as_special(modeladmin, request, queryset):</span>
<span class="sd">                queryset.update(is_special=True)</span>

<span class="sd">            registrar.add_admin_method(</span>
<span class="sd">                MyModel,</span>
<span class="sd">                &quot;mark_as_special&quot;,</span>
<span class="sd">                mark_as_special,</span>
<span class="sd">                short_description=&quot;Mark selected items as special&quot;,</span>
<span class="sd">                is_action=True</span>
<span class="sd">            )</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Validate method_name</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">method_name</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">method_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;method_name must be a non-empty string&quot;</span><span class="p">)</span>

        <span class="c1"># Validate method_func</span>
        <span class="k">if</span> <span class="n">method_func</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;method_func cannot be None&quot;</span><span class="p">)</span>

        <span class="c1"># Validate method_name format (should be a valid Python identifier)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">method_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">isalnum</span><span class="p">()</span> <span class="ow">or</span> <span class="n">method_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;method_name must be a valid Python identifier&quot;</span><span class="p">)</span>

        <span class="n">admin_instance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_admin_class_for_model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>  <span class="c1"># This is the actual live instance</span>

        <span class="n">final_wrapped_method</span><span class="p">:</span> <span class="n">Callable</span>
        <span class="k">if</span> <span class="n">is_action</span><span class="p">:</span>
            <span class="c1"># Wrapper for admin actions</span>
            <span class="c1"># method_func signature: (modeladmin_instance, request, queryset)</span>
            <span class="c1"># Django calls action as: func(modeladmin, request, queryset)</span>
            <span class="c1"># This wrapper ensures the original method_func is called correctly.</span>
            <span class="k">def</span><span class="w"> </span><span class="nf">action_wrapper</span><span class="p">(</span><span class="n">modeladmin_param</span><span class="p">,</span> <span class="n">request_param</span><span class="p">,</span> <span class="n">queryset_param</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">method_func</span><span class="p">(</span><span class="n">modeladmin_param</span><span class="p">,</span> <span class="n">request_param</span><span class="p">,</span> <span class="n">queryset_param</span><span class="p">)</span>

            <span class="n">final_wrapped_method</span> <span class="o">=</span> <span class="n">action_wrapper</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Wrapper for display methods (e.g., in list_display)</span>
            <span class="c1"># method_func signature: (modeladmin_instance, model_instance)</span>
            <span class="c1"># Django calls display method as: admin_instance.method_name(model_instance)</span>
            <span class="c1"># &#39;admin_instance&#39; (the live model admin instance) is available from the outer scope.</span>
            <span class="k">def</span><span class="w"> </span><span class="nf">display_wrapper</span><span class="p">(</span><span class="n">obj_param</span><span class="p">):</span>  <span class="c1"># obj_param is the model_instance passed by Django</span>
                <span class="c1"># admin_instance is the ModelAdmin instance captured from the outer scope of add_admin_method</span>
                <span class="k">return</span> <span class="n">method_func</span><span class="p">(</span><span class="n">admin_instance</span><span class="p">,</span> <span class="n">obj_param</span><span class="p">)</span>

            <span class="n">final_wrapped_method</span> <span class="o">=</span> <span class="n">display_wrapper</span>

        <span class="c1"># Set the wrapped method directly on the admin instance</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="n">admin_instance</span><span class="p">,</span> <span class="n">method_name</span><span class="p">,</span> <span class="n">final_wrapped_method</span><span class="p">)</span>

        <span class="c1"># Set short description if provided (on the final_wrapped_method)</span>
        <span class="k">if</span> <span class="n">short_description</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">final_wrapped_method</span><span class="o">.</span><span class="n">short_description</span> <span class="o">=</span> <span class="n">short_description</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Could not set short_description on wrapped method </span><span class="si">{</span><span class="n">method_name</span><span class="si">}</span><span class="s2"> for model </span><span class="si">{</span><span class="n">model</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Add to actions if requested</span>
        <span class="k">if</span> <span class="n">is_action</span><span class="p">:</span>
            <span class="n">existing_actions</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">admin_instance</span><span class="p">,</span> <span class="s2">&quot;actions&quot;</span><span class="p">,</span> <span class="p">[])</span> <span class="ow">or</span> <span class="p">[])</span>
            <span class="n">action_to_add</span> <span class="o">=</span> <span class="n">final_wrapped_method</span>  <span class="c1"># Add the callable wrapper</span>

            <span class="n">already_present</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">for</span> <span class="n">existing_action</span> <span class="ow">in</span> <span class="n">existing_actions</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">existing_action</span> <span class="o">==</span> <span class="n">action_to_add</span><span class="p">:</span>
                    <span class="n">already_present</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">break</span>
                <span class="c1"># Compare by name if functions are different instances but represent the same action</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">existing_action</span><span class="p">,</span> <span class="s2">&quot;__name__&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">existing_action</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="nb">getattr</span><span class="p">(</span>
                    <span class="n">action_to_add</span><span class="p">,</span>
                    <span class="s2">&quot;__name__&quot;</span><span class="p">,</span>
                    <span class="kc">None</span><span class="p">,</span>
                <span class="p">):</span>
                    <span class="n">already_present</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">break</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">already_present</span><span class="p">:</span>
                <span class="n">existing_actions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">action_to_add</span><span class="p">)</span>
            <span class="n">admin_instance</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="n">existing_actions</span>

        <span class="c1"># Sync the changes to the registered instance</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sync_admin_instance</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">register_models</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Register models with the Django admin site.</span>

<span class="sd">        This method handles the registration process for all models in the app.</span>
<span class="sd">        It ensures that:</span>
<span class="sd">        1. Each model gets the correct admin class type (regular or polymorphic)</span>
<span class="sd">        2. List display and filter properties are properly initialized</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">class_dict</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No admin classes to register for app </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">app_labels</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="c1"># Ensure any explicit app admin.py registrations are loaded first</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">django.contrib.admin</span><span class="w"> </span><span class="kn">import</span> <span class="n">autodiscover</span> <span class="k">as</span> <span class="n">admin_autodiscover</span>

            <span class="n">admin_autodiscover</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="c1"># Autodiscover may be already executed or unavailable in certain contexts</span>
            <span class="k">pass</span>

        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model_adminclass_tuple</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">class_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Registering model </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">model</span><span class="p">,</span> <span class="n">admin_class</span> <span class="o">=</span> <span class="n">model_adminclass_tuple</span>
            <span class="c1"># Skip registration if already registered by third-party/admin.py</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">is_registered</span><span class="p">(</span><span class="n">model</span><span class="p">):</span>  <span class="c1"># type: ignore[attr-defined]</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Model </span><span class="si">{</span><span class="n">model</span><span class="si">}</span><span class="s2"> already registered; skipping auto-registration&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_sync_admin_instance</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
                    <span class="k">continue</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="c1"># Fallback to trying and catching AlreadyRegistered</span>
                <span class="k">pass</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">admin_class</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_sync_admin_instance</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">AlreadyRegistered</span><span class="p">:</span>
                <span class="c1"># If already registered, sync the instance</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_sync_admin_instance</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_search_fields</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">model</span><span class="p">:</span> <span class="n">InclusiveModelType</span><span class="p">,</span>
        <span class="n">search_fields</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="p">):</span>
        <span class="n">admin_class</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_admin_class_for_model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">admin_class</span><span class="p">,</span> <span class="s2">&quot;search_fields&quot;</span><span class="p">):</span>
            <span class="c1"># Pass admin_class to verification</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_verify_list_display_in_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">search_fields</span><span class="p">,</span> <span class="n">admin_class</span><span class="p">)</span>
            <span class="n">admin_class</span><span class="o">.</span><span class="n">search_fields</span> <span class="o">=</span> <span class="n">search_fields</span>  <span class="c1"># type: ignore</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sync_admin_instance</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>  <span class="c1"># Sync after modification</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">append_list_display</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">model</span><span class="p">:</span> <span class="n">InclusiveModelType</span><span class="p">,</span>
        <span class="n">list_display</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add fields to the end of the admin display list.</span>

<span class="sd">        This method:</span>
<span class="sd">        1. Validates that all fields exist on the model</span>
<span class="sd">        2. Maintains field order while preventing duplicates</span>
<span class="sd">        3. Updates both the admin class and registered instance</span>

<span class="sd">        Args:</span>
<span class="sd">            model: The model to modify the admin display for</span>
<span class="sd">            list_display: Fields to add to the display list</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">admin_class</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_admin_class_for_model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">admin_class</span><span class="p">,</span> <span class="s2">&quot;list_display&quot;</span><span class="p">):</span>
            <span class="c1"># Pass admin_class to verification</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_verify_list_display_in_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">list_display</span><span class="p">,</span> <span class="n">admin_class</span><span class="p">)</span>
            <span class="n">current_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tuple_list_handler</span><span class="p">(</span><span class="n">admin_class</span><span class="o">.</span><span class="n">list_display</span><span class="p">)</span>
            <span class="c1"># Add new fields, avoiding duplicates</span>
            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">list_display</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">field</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">current_list</span><span class="p">:</span>
                    <span class="n">current_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>
            <span class="n">admin_class</span><span class="o">.</span><span class="n">list_display</span> <span class="o">=</span> <span class="n">current_list</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sync_admin_instance</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">prepend_list_display</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">model</span><span class="p">:</span> <span class="n">InclusiveModelType</span><span class="p">,</span>
        <span class="n">list_display</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add fields to the start of the admin display list.</span>

<span class="sd">        This method:</span>
<span class="sd">        1. Validates that all fields exist on the model</span>
<span class="sd">        2. Removes any existing instances of the fields</span>
<span class="sd">        3. Prepends fields to the start of the list</span>
<span class="sd">        4. Updates both the admin class and registered instance</span>

<span class="sd">        Args:</span>
<span class="sd">            model: The model to modify the admin display for</span>
<span class="sd">            list_display: Field(s) to add to the start of the display list.</span>
<span class="sd">                         Can be a single string or list/tuple of strings.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">admin_class</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_admin_class_for_model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">admin_class</span><span class="p">,</span> <span class="s2">&quot;list_display&quot;</span><span class="p">):</span>
            <span class="c1"># Convert single string to list</span>
            <span class="n">fields_to_add</span> <span class="o">=</span> <span class="p">[</span><span class="n">list_display</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">list_display</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="nb">list</span><span class="p">(</span><span class="n">list_display</span><span class="p">)</span>

            <span class="c1"># Pass admin_class to verification</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_verify_list_display_in_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">fields_to_add</span><span class="p">,</span> <span class="n">admin_class</span><span class="p">)</span>
            <span class="n">current_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tuple_list_handler</span><span class="p">(</span><span class="n">admin_class</span><span class="o">.</span><span class="n">list_display</span><span class="p">)</span>

            <span class="c1"># Remove any existing instances of the fields</span>
            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">fields_to_add</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">current_list</span><span class="p">:</span>
                    <span class="n">current_list</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>

            <span class="c1"># Add new fields at the start</span>
            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">fields_to_add</span><span class="p">):</span>
                <span class="n">current_list</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">field</span><span class="p">)</span>

            <span class="n">admin_class</span><span class="o">.</span><span class="n">list_display</span> <span class="o">=</span> <span class="n">current_list</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sync_admin_instance</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">remove_list_display</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">model</span><span class="p">:</span> <span class="n">InclusiveModelType</span><span class="p">,</span>
        <span class="n">list_display_to_remove</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">admin_class</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_admin_class_for_model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="n">admin_class</span><span class="o">.</span><span class="n">list_display</span> <span class="o">=</span> <span class="p">[</span><span class="n">field</span> <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">admin_class</span><span class="o">.</span><span class="n">list_display</span> <span class="k">if</span> <span class="n">field</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">list_display_to_remove</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sync_admin_instance</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">append_filter_display</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">model</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">]</span> <span class="o">|</span> <span class="n">models</span><span class="o">.</span><span class="n">Model</span> <span class="o">|</span> <span class="n">PolymorphicModelBase</span><span class="p">,</span>
        <span class="n">list_filter</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add filter fields to the admin display.</span>

<span class="sd">        This method adds fields to the list_filter property of the admin class.</span>
<span class="sd">        It follows the same pattern as list_display management:</span>
<span class="sd">        1. Validates fields exist on the model</span>
<span class="sd">        2. Maintains field order while preventing duplicates</span>
<span class="sd">        3. Updates both admin class and registered instance</span>

<span class="sd">        Args:</span>
<span class="sd">            model: The model to add filters to</span>
<span class="sd">            list_filter: List or tuple of field names to add as filters</span>

<span class="sd">        Raises:</span>
<span class="sd">            KeyError: If model not found in registered classes</span>
<span class="sd">            FieldDoesNotExist: If field doesn&#39;t exist on model</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">admin_class</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_admin_class_for_model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">admin_class</span><span class="p">,</span> <span class="s2">&quot;list_filter&quot;</span><span class="p">):</span>
            <span class="c1"># Pass admin_class to verification (assuming list_filter items should also be valid fields/methods)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_verify_list_display_in_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">list_filter</span><span class="p">,</span> <span class="n">admin_class</span><span class="p">)</span>
            <span class="n">admin_class</span><span class="o">.</span><span class="n">list_filter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tuple_list_handler</span><span class="p">(</span><span class="n">admin_class</span><span class="o">.</span><span class="n">list_filter</span><span class="p">)</span>
            <span class="c1"># Ensure no duplicates are added</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">list_filter</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">item</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">admin_class</span><span class="o">.</span><span class="n">list_filter</span><span class="p">:</span>
                    <span class="n">admin_class</span><span class="o">.</span><span class="n">list_filter</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sync_admin_instance</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">return_admin_class_for_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="n">InclusiveModelType</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the admin class for a model.</span>

<span class="sd">        This method retrieves the admin class associated with a model from the</span>
<span class="sd">        class dictionary. It handles both class and instance model references.</span>

<span class="sd">        The returned admin class can be modified to customize various aspects</span>
<span class="sd">        of the admin interface. See Django&#39;s ModelAdmin documentation for all</span>
<span class="sd">        available options.</span>

<span class="sd">        Args:</span>
<span class="sd">            model: The model to get the admin class for</span>

<span class="sd">        Returns:</span>
<span class="sd">            The admin class for the model</span>

<span class="sd">        Raises:</span>
<span class="sd">            KeyError: If the model is not found in the registered classes</span>

<span class="sd">        Example Usage:</span>
<span class="sd">            admin_class = registrar.return_admin_class_for_model(MyModel)</span>
<span class="sd">            admin_class.list_filter += [&quot;is_custom_component&quot;, &quot;category&quot;]</span>
<span class="sd">            admin_class.show_full_result_count = False</span>
<span class="sd">            admin_class.paginator = TimeLimitedPaginator</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">model_class</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="s2">&quot;type[models.Model]&quot;</span><span class="p">,</span> <span class="n">model</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="nb">type</span><span class="p">)</span> <span class="k">else</span> <span class="n">model</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span>
        <span class="n">registered_instance</span> <span class="o">=</span> <span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">_registry</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">registered_instance</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">registered_instance</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Model </span><span class="si">{</span><span class="n">model_class</span><span class="si">}</span><span class="s2"> not found in registered classes - please register the model first.&quot;</span>
        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">append_inline</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">model</span><span class="p">:</span> <span class="n">InclusiveModelType</span><span class="p">,</span>
        <span class="n">inline_class</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">admin</span><span class="o">.</span><span class="n">TabularInline</span> <span class="o">|</span> <span class="n">admin</span><span class="o">.</span><span class="n">StackedInline</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add an inline class to a model&#39;s admin.</span>

<span class="sd">        This method:</span>
<span class="sd">        1. Gets or creates the inlines list</span>
<span class="sd">        2. Converts tuple to list if needed</span>
<span class="sd">        3. Appends the new inline</span>
<span class="sd">        4. Updates both admin class and registered instance</span>

<span class="sd">        Args:</span>
<span class="sd">            model: The model to add the inline to</span>
<span class="sd">            inline_class: The inline class to add</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">admin_class</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_admin_class_for_model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

        <span class="c1"># Initialize or convert inlines to list</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">admin_class</span><span class="p">,</span> <span class="s2">&quot;inlines&quot;</span><span class="p">):</span>
            <span class="n">admin_class</span><span class="o">.</span><span class="n">inlines</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">admin_class</span><span class="o">.</span><span class="n">inlines</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">admin_class</span><span class="o">.</span><span class="n">inlines</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">admin_class</span><span class="o">.</span><span class="n">inlines</span><span class="p">)</span>

        <span class="c1"># Add inline if not already present</span>
        <span class="k">if</span> <span class="n">inline_class</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">admin_class</span><span class="o">.</span><span class="n">inlines</span><span class="p">:</span>
            <span class="n">admin_class</span><span class="o">.</span><span class="n">inlines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inline_class</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_sync_admin_instance</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="django_admin_magic.registrar.AdminModelRegistrar.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">app_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">app_labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">auto_discover</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#django_admin_magic.registrar.AdminModelRegistrar.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Initialize the registrar for specific Django app(s).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>app_label</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The label of a single Django app to register models for.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>app_labels</code>
            </td>
            <td>
                  <code><span title="List">List</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of Django app labels to register models for.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>auto_discover</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to auto-discover and register all installed apps.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/django_admin_magic/registrar.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">app_label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">app_labels</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">auto_discover</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize the registrar for specific Django app(s).</span>

<span class="sd">    Args:</span>
<span class="sd">        app_label (str, optional): The label of a single Django app to register models for.</span>
<span class="sd">        app_labels (List[str], optional): List of Django app labels to register models for.</span>
<span class="sd">        auto_discover (bool): Whether to auto-discover and register all installed apps.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">class_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">InclusiveModelType</span><span class="p">,</span> <span class="n">AdminClassType</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">app_labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_determine_app_labels</span><span class="p">(</span><span class="n">app_label</span><span class="p">,</span> <span class="n">app_labels</span><span class="p">,</span> <span class="n">auto_discover</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">do_not_register_filter_string_list</span> <span class="o">=</span> <span class="n">app_settings</span><span class="o">.</span><span class="n">DEFAULT_DO_NOT_REGISTER_FILTER_STRING_LIST</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">models</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_collect_models</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">model_iterator</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">register_models</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="django_admin_magic.registrar.AdminModelRegistrar.add_admin_method" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_admin_method</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">method_name</span><span class="p">,</span> <span class="n">method_func</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">short_description</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_action</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#django_admin_magic.registrar.AdminModelRegistrar.add_admin_method" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Add a method to the admin class for a model.</p>
<p>This method allows adding custom methods to the admin class, optionally
marking them as actions and setting their short descriptions.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code><span title="django_admin_magic.registrar.InclusiveModelType">InclusiveModelType</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The model to add the method to</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>method_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name to give the method</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>method_func</code>
            </td>
            <td>
                  <code><span title="collections.abc.Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The method to add (should be a function)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>short_description</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional description for the method in admin interface</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_action</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to add this method to the actions list</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <p>def mark_as_special(modeladmin, request, queryset):
    queryset.update(is_special=True)</p>
<p>registrar.add_admin_method(
    MyModel,
    "mark_as_special",
    mark_as_special,
    short_description="Mark selected items as special",
    is_action=True
)</p>
</details>

            <details class="quote">
              <summary>Source code in <code>src/django_admin_magic/registrar.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_admin_method</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">InclusiveModelType</span><span class="p">,</span>
    <span class="n">method_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">method_func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">short_description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">is_action</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add a method to the admin class for a model.</span>

<span class="sd">    This method allows adding custom methods to the admin class, optionally</span>
<span class="sd">    marking them as actions and setting their short descriptions.</span>

<span class="sd">    Args:</span>
<span class="sd">        model: The model to add the method to</span>
<span class="sd">        method_name: The name to give the method</span>
<span class="sd">        method_func: The method to add (should be a function)</span>
<span class="sd">        short_description: Optional description for the method in admin interface</span>
<span class="sd">        is_action: Whether to add this method to the actions list</span>

<span class="sd">    Example:</span>
<span class="sd">        def mark_as_special(modeladmin, request, queryset):</span>
<span class="sd">            queryset.update(is_special=True)</span>

<span class="sd">        registrar.add_admin_method(</span>
<span class="sd">            MyModel,</span>
<span class="sd">            &quot;mark_as_special&quot;,</span>
<span class="sd">            mark_as_special,</span>
<span class="sd">            short_description=&quot;Mark selected items as special&quot;,</span>
<span class="sd">            is_action=True</span>
<span class="sd">        )</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Validate method_name</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">method_name</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">method_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;method_name must be a non-empty string&quot;</span><span class="p">)</span>

    <span class="c1"># Validate method_func</span>
    <span class="k">if</span> <span class="n">method_func</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;method_func cannot be None&quot;</span><span class="p">)</span>

    <span class="c1"># Validate method_name format (should be a valid Python identifier)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">method_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">isalnum</span><span class="p">()</span> <span class="ow">or</span> <span class="n">method_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;method_name must be a valid Python identifier&quot;</span><span class="p">)</span>

    <span class="n">admin_instance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_admin_class_for_model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>  <span class="c1"># This is the actual live instance</span>

    <span class="n">final_wrapped_method</span><span class="p">:</span> <span class="n">Callable</span>
    <span class="k">if</span> <span class="n">is_action</span><span class="p">:</span>
        <span class="c1"># Wrapper for admin actions</span>
        <span class="c1"># method_func signature: (modeladmin_instance, request, queryset)</span>
        <span class="c1"># Django calls action as: func(modeladmin, request, queryset)</span>
        <span class="c1"># This wrapper ensures the original method_func is called correctly.</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">action_wrapper</span><span class="p">(</span><span class="n">modeladmin_param</span><span class="p">,</span> <span class="n">request_param</span><span class="p">,</span> <span class="n">queryset_param</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">method_func</span><span class="p">(</span><span class="n">modeladmin_param</span><span class="p">,</span> <span class="n">request_param</span><span class="p">,</span> <span class="n">queryset_param</span><span class="p">)</span>

        <span class="n">final_wrapped_method</span> <span class="o">=</span> <span class="n">action_wrapper</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Wrapper for display methods (e.g., in list_display)</span>
        <span class="c1"># method_func signature: (modeladmin_instance, model_instance)</span>
        <span class="c1"># Django calls display method as: admin_instance.method_name(model_instance)</span>
        <span class="c1"># &#39;admin_instance&#39; (the live model admin instance) is available from the outer scope.</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">display_wrapper</span><span class="p">(</span><span class="n">obj_param</span><span class="p">):</span>  <span class="c1"># obj_param is the model_instance passed by Django</span>
            <span class="c1"># admin_instance is the ModelAdmin instance captured from the outer scope of add_admin_method</span>
            <span class="k">return</span> <span class="n">method_func</span><span class="p">(</span><span class="n">admin_instance</span><span class="p">,</span> <span class="n">obj_param</span><span class="p">)</span>

        <span class="n">final_wrapped_method</span> <span class="o">=</span> <span class="n">display_wrapper</span>

    <span class="c1"># Set the wrapped method directly on the admin instance</span>
    <span class="nb">setattr</span><span class="p">(</span><span class="n">admin_instance</span><span class="p">,</span> <span class="n">method_name</span><span class="p">,</span> <span class="n">final_wrapped_method</span><span class="p">)</span>

    <span class="c1"># Set short description if provided (on the final_wrapped_method)</span>
    <span class="k">if</span> <span class="n">short_description</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">final_wrapped_method</span><span class="o">.</span><span class="n">short_description</span> <span class="o">=</span> <span class="n">short_description</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Could not set short_description on wrapped method </span><span class="si">{</span><span class="n">method_name</span><span class="si">}</span><span class="s2"> for model </span><span class="si">{</span><span class="n">model</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Add to actions if requested</span>
    <span class="k">if</span> <span class="n">is_action</span><span class="p">:</span>
        <span class="n">existing_actions</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">admin_instance</span><span class="p">,</span> <span class="s2">&quot;actions&quot;</span><span class="p">,</span> <span class="p">[])</span> <span class="ow">or</span> <span class="p">[])</span>
        <span class="n">action_to_add</span> <span class="o">=</span> <span class="n">final_wrapped_method</span>  <span class="c1"># Add the callable wrapper</span>

        <span class="n">already_present</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">existing_action</span> <span class="ow">in</span> <span class="n">existing_actions</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">existing_action</span> <span class="o">==</span> <span class="n">action_to_add</span><span class="p">:</span>
                <span class="n">already_present</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">break</span>
            <span class="c1"># Compare by name if functions are different instances but represent the same action</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">existing_action</span><span class="p">,</span> <span class="s2">&quot;__name__&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">existing_action</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="nb">getattr</span><span class="p">(</span>
                <span class="n">action_to_add</span><span class="p">,</span>
                <span class="s2">&quot;__name__&quot;</span><span class="p">,</span>
                <span class="kc">None</span><span class="p">,</span>
            <span class="p">):</span>
                <span class="n">already_present</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">break</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">already_present</span><span class="p">:</span>
            <span class="n">existing_actions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">action_to_add</span><span class="p">)</span>
        <span class="n">admin_instance</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="n">existing_actions</span>

    <span class="c1"># Sync the changes to the registered instance</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_sync_admin_instance</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="django_admin_magic.registrar.AdminModelRegistrar.append_filter_display" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">append_filter_display</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">list_filter</span><span class="p">)</span></code>

<a href="#django_admin_magic.registrar.AdminModelRegistrar.append_filter_display" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Add filter fields to the admin display.</p>
<p>This method adds fields to the list_filter property of the admin class.
It follows the same pattern as list_display management:
1. Validates fields exist on the model
2. Maintains field order while preventing duplicates
3. Updates both admin class and registered instance</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code><span title="type">type</span>[<span title="django_admin_magic.registrar.AdminModelRegistrar.models.Model">Model</span>] | <span title="django_admin_magic.registrar.AdminModelRegistrar.models.Model">Model</span> | <span title="polymorphic.models.PolymorphicModelBase">PolymorphicModelBase</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The model to add filters to</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>list_filter</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>] | <span title="tuple">tuple</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List or tuple of field names to add as filters</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="KeyError">KeyError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If model not found in registered classes</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="django.core.exceptions.FieldDoesNotExist">FieldDoesNotExist</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If field doesn't exist on model</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/django_admin_magic/registrar.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">append_filter_display</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">model</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">]</span> <span class="o">|</span> <span class="n">models</span><span class="o">.</span><span class="n">Model</span> <span class="o">|</span> <span class="n">PolymorphicModelBase</span><span class="p">,</span>
    <span class="n">list_filter</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add filter fields to the admin display.</span>

<span class="sd">    This method adds fields to the list_filter property of the admin class.</span>
<span class="sd">    It follows the same pattern as list_display management:</span>
<span class="sd">    1. Validates fields exist on the model</span>
<span class="sd">    2. Maintains field order while preventing duplicates</span>
<span class="sd">    3. Updates both admin class and registered instance</span>

<span class="sd">    Args:</span>
<span class="sd">        model: The model to add filters to</span>
<span class="sd">        list_filter: List or tuple of field names to add as filters</span>

<span class="sd">    Raises:</span>
<span class="sd">        KeyError: If model not found in registered classes</span>
<span class="sd">        FieldDoesNotExist: If field doesn&#39;t exist on model</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">admin_class</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_admin_class_for_model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">admin_class</span><span class="p">,</span> <span class="s2">&quot;list_filter&quot;</span><span class="p">):</span>
        <span class="c1"># Pass admin_class to verification (assuming list_filter items should also be valid fields/methods)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_verify_list_display_in_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">list_filter</span><span class="p">,</span> <span class="n">admin_class</span><span class="p">)</span>
        <span class="n">admin_class</span><span class="o">.</span><span class="n">list_filter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tuple_list_handler</span><span class="p">(</span><span class="n">admin_class</span><span class="o">.</span><span class="n">list_filter</span><span class="p">)</span>
        <span class="c1"># Ensure no duplicates are added</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">list_filter</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">item</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">admin_class</span><span class="o">.</span><span class="n">list_filter</span><span class="p">:</span>
                <span class="n">admin_class</span><span class="o">.</span><span class="n">list_filter</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sync_admin_instance</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="django_admin_magic.registrar.AdminModelRegistrar.append_inline" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">append_inline</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">inline_class</span><span class="p">)</span></code>

<a href="#django_admin_magic.registrar.AdminModelRegistrar.append_inline" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Add an inline class to a model's admin.</p>
<p>This method:
1. Gets or creates the inlines list
2. Converts tuple to list if needed
3. Appends the new inline
4. Updates both admin class and registered instance</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code><span title="django_admin_magic.registrar.InclusiveModelType">InclusiveModelType</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The model to add the inline to</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>inline_class</code>
            </td>
            <td>
                  <code><span title="type">type</span>[<span title="django.contrib.admin.TabularInline">TabularInline</span> | <span title="django.contrib.admin.StackedInline">StackedInline</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The inline class to add</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/django_admin_magic/registrar.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">append_inline</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">InclusiveModelType</span><span class="p">,</span>
    <span class="n">inline_class</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">admin</span><span class="o">.</span><span class="n">TabularInline</span> <span class="o">|</span> <span class="n">admin</span><span class="o">.</span><span class="n">StackedInline</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add an inline class to a model&#39;s admin.</span>

<span class="sd">    This method:</span>
<span class="sd">    1. Gets or creates the inlines list</span>
<span class="sd">    2. Converts tuple to list if needed</span>
<span class="sd">    3. Appends the new inline</span>
<span class="sd">    4. Updates both admin class and registered instance</span>

<span class="sd">    Args:</span>
<span class="sd">        model: The model to add the inline to</span>
<span class="sd">        inline_class: The inline class to add</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">admin_class</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_admin_class_for_model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

    <span class="c1"># Initialize or convert inlines to list</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">admin_class</span><span class="p">,</span> <span class="s2">&quot;inlines&quot;</span><span class="p">):</span>
        <span class="n">admin_class</span><span class="o">.</span><span class="n">inlines</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">admin_class</span><span class="o">.</span><span class="n">inlines</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
        <span class="n">admin_class</span><span class="o">.</span><span class="n">inlines</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">admin_class</span><span class="o">.</span><span class="n">inlines</span><span class="p">)</span>

    <span class="c1"># Add inline if not already present</span>
    <span class="k">if</span> <span class="n">inline_class</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">admin_class</span><span class="o">.</span><span class="n">inlines</span><span class="p">:</span>
        <span class="n">admin_class</span><span class="o">.</span><span class="n">inlines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inline_class</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_sync_admin_instance</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="django_admin_magic.registrar.AdminModelRegistrar.append_list_display" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">append_list_display</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">list_display</span><span class="p">)</span></code>

<a href="#django_admin_magic.registrar.AdminModelRegistrar.append_list_display" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Add fields to the end of the admin display list.</p>
<p>This method:
1. Validates that all fields exist on the model
2. Maintains field order while preventing duplicates
3. Updates both the admin class and registered instance</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code><span title="django_admin_magic.registrar.InclusiveModelType">InclusiveModelType</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The model to modify the admin display for</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>list_display</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>] | <span title="tuple">tuple</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Fields to add to the display list</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/django_admin_magic/registrar.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">append_list_display</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">InclusiveModelType</span><span class="p">,</span>
    <span class="n">list_display</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add fields to the end of the admin display list.</span>

<span class="sd">    This method:</span>
<span class="sd">    1. Validates that all fields exist on the model</span>
<span class="sd">    2. Maintains field order while preventing duplicates</span>
<span class="sd">    3. Updates both the admin class and registered instance</span>

<span class="sd">    Args:</span>
<span class="sd">        model: The model to modify the admin display for</span>
<span class="sd">        list_display: Fields to add to the display list</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">admin_class</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_admin_class_for_model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">admin_class</span><span class="p">,</span> <span class="s2">&quot;list_display&quot;</span><span class="p">):</span>
        <span class="c1"># Pass admin_class to verification</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_verify_list_display_in_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">list_display</span><span class="p">,</span> <span class="n">admin_class</span><span class="p">)</span>
        <span class="n">current_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tuple_list_handler</span><span class="p">(</span><span class="n">admin_class</span><span class="o">.</span><span class="n">list_display</span><span class="p">)</span>
        <span class="c1"># Add new fields, avoiding duplicates</span>
        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">list_display</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">field</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">current_list</span><span class="p">:</span>
                <span class="n">current_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>
        <span class="n">admin_class</span><span class="o">.</span><span class="n">list_display</span> <span class="o">=</span> <span class="n">current_list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sync_admin_instance</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="django_admin_magic.registrar.AdminModelRegistrar.model_iterator" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">model_iterator</span><span class="p">()</span></code>

<a href="#django_admin_magic.registrar.AdminModelRegistrar.model_iterator" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Iterates through models and creates the associated admin class.
Convenience method to create admin classes for models without
having to explicitly create them in each app's admin.py file.</p>


            <details class="quote">
              <summary>Source code in <code>src/django_admin_magic/registrar.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">model_iterator</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Iterates through models and creates the associated admin class.</span>
<span class="sd">    Convenience method to create admin classes for models without</span>
<span class="sd">    having to explicitly create them in each app&#39;s admin.py file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">:</span>
        <span class="n">model_name</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="vm">__name__</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="nb">type</span><span class="p">)</span> <span class="k">else</span> <span class="n">model</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="n">model_passes_filter</span> <span class="o">=</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">x</span> <span class="ow">in</span> <span class="n">model_name</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_not_register_filter_string_list</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">abstract</span> <span class="ow">is</span> <span class="kc">False</span> <span class="ow">and</span> <span class="n">model_passes_filter</span><span class="p">:</span>
            <span class="n">admin_class</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_admin_class_factory</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">class_dict</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">model</span><span class="p">)]</span> <span class="o">=</span> <span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">admin_class</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="django_admin_magic.registrar.AdminModelRegistrar.prepend_list_display" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">prepend_list_display</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">list_display</span><span class="p">)</span></code>

<a href="#django_admin_magic.registrar.AdminModelRegistrar.prepend_list_display" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Add fields to the start of the admin display list.</p>
<p>This method:
1. Validates that all fields exist on the model
2. Removes any existing instances of the fields
3. Prepends fields to the start of the list
4. Updates both the admin class and registered instance</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code><span title="django_admin_magic.registrar.InclusiveModelType">InclusiveModelType</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The model to modify the admin display for</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>list_display</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="list">list</span>[<span title="str">str</span>] | <span title="tuple">tuple</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Field(s) to add to the start of the display list.
         Can be a single string or list/tuple of strings.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/django_admin_magic/registrar.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">prepend_list_display</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">InclusiveModelType</span><span class="p">,</span>
    <span class="n">list_display</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add fields to the start of the admin display list.</span>

<span class="sd">    This method:</span>
<span class="sd">    1. Validates that all fields exist on the model</span>
<span class="sd">    2. Removes any existing instances of the fields</span>
<span class="sd">    3. Prepends fields to the start of the list</span>
<span class="sd">    4. Updates both the admin class and registered instance</span>

<span class="sd">    Args:</span>
<span class="sd">        model: The model to modify the admin display for</span>
<span class="sd">        list_display: Field(s) to add to the start of the display list.</span>
<span class="sd">                     Can be a single string or list/tuple of strings.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">admin_class</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_admin_class_for_model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">admin_class</span><span class="p">,</span> <span class="s2">&quot;list_display&quot;</span><span class="p">):</span>
        <span class="c1"># Convert single string to list</span>
        <span class="n">fields_to_add</span> <span class="o">=</span> <span class="p">[</span><span class="n">list_display</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">list_display</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="nb">list</span><span class="p">(</span><span class="n">list_display</span><span class="p">)</span>

        <span class="c1"># Pass admin_class to verification</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_verify_list_display_in_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">fields_to_add</span><span class="p">,</span> <span class="n">admin_class</span><span class="p">)</span>
        <span class="n">current_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tuple_list_handler</span><span class="p">(</span><span class="n">admin_class</span><span class="o">.</span><span class="n">list_display</span><span class="p">)</span>

        <span class="c1"># Remove any existing instances of the fields</span>
        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">fields_to_add</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">current_list</span><span class="p">:</span>
                <span class="n">current_list</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>

        <span class="c1"># Add new fields at the start</span>
        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">fields_to_add</span><span class="p">):</span>
            <span class="n">current_list</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">field</span><span class="p">)</span>

        <span class="n">admin_class</span><span class="o">.</span><span class="n">list_display</span> <span class="o">=</span> <span class="n">current_list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sync_admin_instance</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="django_admin_magic.registrar.AdminModelRegistrar.register_all_discovered_apps" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">register_all_discovered_apps</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#django_admin_magic.registrar.AdminModelRegistrar.register_all_discovered_apps" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Class method to create a registrar that auto-discovers and registers all apps.</p>
<p>This is useful for users who want to register all their models automatically
without specifying individual app labels.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="AdminModelRegistrar (django_admin_magic.registrar.AdminModelRegistrar)" href="#django_admin_magic.registrar.AdminModelRegistrar">AdminModelRegistrar</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>AdminModelRegistrar instance configured for auto-discovery</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/django_admin_magic/registrar.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">register_all_discovered_apps</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;AdminModelRegistrar&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class method to create a registrar that auto-discovers and registers all apps.</span>

<span class="sd">    This is useful for users who want to register all their models automatically</span>
<span class="sd">    without specifying individual app labels.</span>

<span class="sd">    Returns:</span>
<span class="sd">        AdminModelRegistrar instance configured for auto-discovery</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">auto_discover</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="django_admin_magic.registrar.AdminModelRegistrar.register_app" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">register_app</span><span class="p">(</span><span class="n">app_label</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#django_admin_magic.registrar.AdminModelRegistrar.register_app" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Class method to create a registrar for a single app.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>app_label</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The app label to register</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="AdminModelRegistrar (django_admin_magic.registrar.AdminModelRegistrar)" href="#django_admin_magic.registrar.AdminModelRegistrar">AdminModelRegistrar</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>AdminModelRegistrar instance configured for the specified app</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/django_admin_magic/registrar.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">register_app</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">app_label</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;AdminModelRegistrar&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class method to create a registrar for a single app.</span>

<span class="sd">    Args:</span>
<span class="sd">        app_label: The app label to register</span>

<span class="sd">    Returns:</span>
<span class="sd">        AdminModelRegistrar instance configured for the specified app</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">app_label</span><span class="o">=</span><span class="n">app_label</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="django_admin_magic.registrar.AdminModelRegistrar.register_apps" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">register_apps</span><span class="p">(</span><span class="n">app_labels</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#django_admin_magic.registrar.AdminModelRegistrar.register_apps" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Class method to create a registrar for specific app labels.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>app_labels</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of app labels to register</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="AdminModelRegistrar (django_admin_magic.registrar.AdminModelRegistrar)" href="#django_admin_magic.registrar.AdminModelRegistrar">AdminModelRegistrar</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>AdminModelRegistrar instance configured for the specified apps</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/django_admin_magic/registrar.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">register_apps</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">app_labels</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s2">&quot;AdminModelRegistrar&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class method to create a registrar for specific app labels.</span>

<span class="sd">    Args:</span>
<span class="sd">        app_labels: List of app labels to register</span>

<span class="sd">    Returns:</span>
<span class="sd">        AdminModelRegistrar instance configured for the specified apps</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">app_labels</span><span class="o">=</span><span class="n">app_labels</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="django_admin_magic.registrar.AdminModelRegistrar.register_models" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">register_models</span><span class="p">()</span></code>

<a href="#django_admin_magic.registrar.AdminModelRegistrar.register_models" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Register models with the Django admin site.</p>
<p>This method handles the registration process for all models in the app.
It ensures that:
1. Each model gets the correct admin class type (regular or polymorphic)
2. List display and filter properties are properly initialized</p>


            <details class="quote">
              <summary>Source code in <code>src/django_admin_magic/registrar.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">register_models</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Register models with the Django admin site.</span>

<span class="sd">    This method handles the registration process for all models in the app.</span>
<span class="sd">    It ensures that:</span>
<span class="sd">    1. Each model gets the correct admin class type (regular or polymorphic)</span>
<span class="sd">    2. List display and filter properties are properly initialized</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">class_dict</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No admin classes to register for app </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">app_labels</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="c1"># Ensure any explicit app admin.py registrations are loaded first</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">django.contrib.admin</span><span class="w"> </span><span class="kn">import</span> <span class="n">autodiscover</span> <span class="k">as</span> <span class="n">admin_autodiscover</span>

        <span class="n">admin_autodiscover</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="c1"># Autodiscover may be already executed or unavailable in certain contexts</span>
        <span class="k">pass</span>

    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model_adminclass_tuple</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">class_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Registering model </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">model</span><span class="p">,</span> <span class="n">admin_class</span> <span class="o">=</span> <span class="n">model_adminclass_tuple</span>
        <span class="c1"># Skip registration if already registered by third-party/admin.py</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">is_registered</span><span class="p">(</span><span class="n">model</span><span class="p">):</span>  <span class="c1"># type: ignore[attr-defined]</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Model </span><span class="si">{</span><span class="n">model</span><span class="si">}</span><span class="s2"> already registered; skipping auto-registration&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_sync_admin_instance</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
                <span class="k">continue</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="c1"># Fallback to trying and catching AlreadyRegistered</span>
            <span class="k">pass</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">admin_class</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sync_admin_instance</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">AlreadyRegistered</span><span class="p">:</span>
            <span class="c1"># If already registered, sync the instance</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sync_admin_instance</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="django_admin_magic.registrar.AdminModelRegistrar.return_admin_class_for_model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">return_admin_class_for_model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span></code>

<a href="#django_admin_magic.registrar.AdminModelRegistrar.return_admin_class_for_model" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Return the admin class for a model.</p>
<p>This method retrieves the admin class associated with a model from the
class dictionary. It handles both class and instance model references.</p>
<p>The returned admin class can be modified to customize various aspects
of the admin interface. See Django's ModelAdmin documentation for all
available options.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code><span title="django_admin_magic.registrar.InclusiveModelType">InclusiveModelType</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The model to get the admin class for</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The admin class for the model</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="KeyError">KeyError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the model is not found in the registered classes</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example-usage" open>
  <summary>Example Usage</summary>
  <p>admin_class = registrar.return_admin_class_for_model(MyModel)
admin_class.list_filter += ["is_custom_component", "category"]
admin_class.show_full_result_count = False
admin_class.paginator = TimeLimitedPaginator</p>
</details>

            <details class="quote">
              <summary>Source code in <code>src/django_admin_magic/registrar.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">return_admin_class_for_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="n">InclusiveModelType</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the admin class for a model.</span>

<span class="sd">    This method retrieves the admin class associated with a model from the</span>
<span class="sd">    class dictionary. It handles both class and instance model references.</span>

<span class="sd">    The returned admin class can be modified to customize various aspects</span>
<span class="sd">    of the admin interface. See Django&#39;s ModelAdmin documentation for all</span>
<span class="sd">    available options.</span>

<span class="sd">    Args:</span>
<span class="sd">        model: The model to get the admin class for</span>

<span class="sd">    Returns:</span>
<span class="sd">        The admin class for the model</span>

<span class="sd">    Raises:</span>
<span class="sd">        KeyError: If the model is not found in the registered classes</span>

<span class="sd">    Example Usage:</span>
<span class="sd">        admin_class = registrar.return_admin_class_for_model(MyModel)</span>
<span class="sd">        admin_class.list_filter += [&quot;is_custom_component&quot;, &quot;category&quot;]</span>
<span class="sd">        admin_class.show_full_result_count = False</span>
<span class="sd">        admin_class.paginator = TimeLimitedPaginator</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">model_class</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="s2">&quot;type[models.Model]&quot;</span><span class="p">,</span> <span class="n">model</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="nb">type</span><span class="p">)</span> <span class="k">else</span> <span class="n">model</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span>
    <span class="n">registered_instance</span> <span class="o">=</span> <span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">_registry</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">registered_instance</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">registered_instance</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Model </span><span class="si">{</span><span class="n">model_class</span><span class="si">}</span><span class="s2"> not found in registered classes - please register the model first.&quot;</span>
    <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="django_admin_magic.registrar.AdminModelRegistrar.update_list_select_related" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">update_list_select_related</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">list_select_related</span><span class="p">)</span></code>

<a href="#django_admin_magic.registrar.AdminModelRegistrar.update_list_select_related" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Update the list_select_related property for a model's admin class.</p>
<p>This method allows setting the list_select_related property to optimize
database queries for the admin changelist view. It can be:
- True: Select all foreign key relationships
- False: Don't use any JOINs
- List/tuple of field names: Only JOIN the specified relationships</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code><span title="django_admin_magic.registrar.InclusiveModelType">InclusiveModelType</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The model whose admin class should be updated</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>list_select_related</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<span title="str">str</span>] | <span title="tuple">tuple</span>[<span title="str">str</span>, ...] | <span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The value to set for list_select_related</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <h4 id="django_admin_magic.registrar.AdminModelRegistrar.update_list_select_related--to-select-all-foreign-keys">To select all foreign keys<a class="headerlink" href="#django_admin_magic.registrar.AdminModelRegistrar.update_list_select_related--to-select-all-foreign-keys" title="Permanent link">&para;</a></h4>
<p>registrar.update_list_select_related(MyModel, True)</p>
<h4 id="django_admin_magic.registrar.AdminModelRegistrar.update_list_select_related--to-select-specific-foreign-keys">To select specific foreign keys<a class="headerlink" href="#django_admin_magic.registrar.AdminModelRegistrar.update_list_select_related--to-select-specific-foreign-keys" title="Permanent link">&para;</a></h4>
<p>registrar.update_list_select_related(MyModel, ['author', 'category'])</p>
<h4 id="django_admin_magic.registrar.AdminModelRegistrar.update_list_select_related--to-disable-all-automatic-joins">To disable all automatic JOINs<a class="headerlink" href="#django_admin_magic.registrar.AdminModelRegistrar.update_list_select_related--to-disable-all-automatic-joins" title="Permanent link">&para;</a></h4>
<p>registrar.update_list_select_related(MyModel, False)</p>
</details>

            <details class="quote">
              <summary>Source code in <code>src/django_admin_magic/registrar.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">update_list_select_related</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">InclusiveModelType</span><span class="p">,</span>
    <span class="n">list_select_related</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">|</span> <span class="nb">bool</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Update the list_select_related property for a model&#39;s admin class.</span>

<span class="sd">    This method allows setting the list_select_related property to optimize</span>
<span class="sd">    database queries for the admin changelist view. It can be:</span>
<span class="sd">    - True: Select all foreign key relationships</span>
<span class="sd">    - False: Don&#39;t use any JOINs</span>
<span class="sd">    - List/tuple of field names: Only JOIN the specified relationships</span>

<span class="sd">    Args:</span>
<span class="sd">        model: The model whose admin class should be updated</span>
<span class="sd">        list_select_related: The value to set for list_select_related</span>

<span class="sd">    Example:</span>
<span class="sd">        # To select all foreign keys</span>
<span class="sd">        registrar.update_list_select_related(MyModel, True)</span>

<span class="sd">        # To select specific foreign keys</span>
<span class="sd">        registrar.update_list_select_related(MyModel, [&#39;author&#39;, &#39;category&#39;])</span>

<span class="sd">        # To disable all automatic JOINs</span>
<span class="sd">        registrar.update_list_select_related(MyModel, False)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">admin_class</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_admin_class_for_model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">admin_class</span><span class="o">.</span><span class="n">list_select_related</span> <span class="o">=</span> <span class="n">list_select_related</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_sync_admin_instance</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="django_admin_magic.registrar.NoOpRegistrar" class="doc doc-heading">
            <code>NoOpRegistrar</code>


<a href="#django_admin_magic.registrar.NoOpRegistrar" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">


        <p>Registrar that performs no operations.</p>
<p>Used when auto-registration is disabled (e.g., during migrations or when admin
is not installed). Provides the same API surface as the real registrar but
all methods are safe no-ops to avoid import-time side effects.</p>







              <details class="quote">
                <summary>Source code in <code>src/django_admin_magic/registrar.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">NoOpRegistrar</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Registrar that performs no operations.</span>

<span class="sd">    Used when auto-registration is disabled (e.g., during migrations or when admin</span>
<span class="sd">    is not installed). Provides the same API surface as the real registrar but</span>
<span class="sd">    all methods are safe no-ops to avoid import-time side effects.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">app_label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">app_labels</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">auto_discover</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">app_labels</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">register_all_discovered_apps</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;NoOpRegistrar&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">auto_discover</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">register_apps</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">app_labels</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s2">&quot;NoOpRegistrar&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">app_labels</span><span class="o">=</span><span class="n">app_labels</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">register_app</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">app_label</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;NoOpRegistrar&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">app_label</span><span class="o">=</span><span class="n">app_label</span><span class="p">)</span>

    <span class="c1"># Common mutator methods are implemented as no-ops</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">register_models</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">return_admin_class_for_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="n">InclusiveModelType</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;Auto admin registration is disabled; no admin classes are available.&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_search_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">append_list_display</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">prepend_list_display</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">remove_list_display</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">append_filter_display</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">append_inline</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="django_admin_magic.registrar.PolymorphicAdminModelRegistrar" class="doc doc-heading">
            <code>PolymorphicAdminModelRegistrar</code>


<a href="#django_admin_magic.registrar.PolymorphicAdminModelRegistrar" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="AdminModelRegistrar (django_admin_magic.registrar.AdminModelRegistrar)" href="#django_admin_magic.registrar.AdminModelRegistrar">AdminModelRegistrar</a></code></p>


        <p>An extension of AdminModelRegistrar that handles polymorphic models.</p>







              <details class="quote">
                <summary>Source code in <code>src/django_admin_magic/registrar.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">PolymorphicAdminModelRegistrar</span><span class="p">(</span><span class="n">AdminModelRegistrar</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;An extension of AdminModelRegistrar that handles polymorphic models.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_admin_class_factory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">admin_site</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates class prototypes for admin_classes depending on the incoming model object.</span>
<span class="sd">        This method handles both regular and polymorphic models.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">adminclass_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;AdminClass_</span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">common_class_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;model&quot;</span><span class="p">:</span> <span class="n">model</span><span class="p">,</span> <span class="s2">&quot;admin_site&quot;</span><span class="p">:</span> <span class="n">admin_site</span><span class="p">}</span>
        <span class="k">if</span> <span class="n">is_polymorphic_model</span><span class="p">(</span><span class="n">model</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">is_polymorphic_model_parent_model</span><span class="p">(</span><span class="n">model</span><span class="p">):</span>
                <span class="k">return</span> <span class="nb">type</span><span class="p">(</span>
                    <span class="n">adminclass_name</span><span class="p">,</span>
                    <span class="p">(</span><span class="n">PolymorphicParentListAdmin</span><span class="p">,),</span>
                    <span class="n">common_class_kwargs</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">return</span> <span class="nb">type</span><span class="p">(</span>
                <span class="n">adminclass_name</span><span class="p">,</span>
                <span class="p">(</span><span class="n">PolymorphicChildListAdmin</span><span class="p">,),</span>
                <span class="n">common_class_kwargs</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_admin_class_factory</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">admin_site</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>




  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.sections", "navigation.instant", "navigation.tracking", "navigation.expand", "navigation.path", "search.suggest", "search.highlight", "content.code.copy", "content.code.annotate", "content.tabs.link", "toc.integrate", "toc.follow", "search.share"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.92b07e13.min.js"></script>
      
    
  </body>
</html>